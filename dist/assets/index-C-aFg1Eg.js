import{a as o,j as e,F as He,c as Ge,N as pe,d as G,e as dt,f as Xe,g as H,h as ye,i as ie,k as Qe,l as ct,m as oe,n as xt,z as K,o as gt,p as ce,q as ht,t as mt,u as ut,v as re,w as Ne,x as Ye,y as xe,A as je,B as X,C as bt,D as Q,E as se,G as de,H as ae,I as ve,J as Je,K as We,b as Ze,L as pt,M as ft,O as ge,Q as yt,S as et,T as jt,U as vt,V as tt,W as U,X as we,Y as me,Z as ke,_ as Nt,$ as wt,a0 as st,a1 as kt,a2 as St,a3 as he,a4 as Ct,a5 as ue,a6 as at,a7 as rt,a8 as _t,a9 as Tt,aa as Ft,ab as J,ac as Lt,ad as zt,ae as $t,af as It,ag as Dt}from"./vendor-react-eJX9ncIv.js";import{aW as Pt}from"./vendor-Q8dlj2J1.js";import{m as v,A}from"./vendor-ui-D_myDNb1.js";import{R as Et,A as Vt,C as Mt,X as Ot,Y as At,T as Kt,a as qt}from"./vendor-data-BlXyhrKN.js";import{E as Bt}from"./vendor-pdf-print-C0Dcv1CW.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const m of l.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&r(m)}).observe(document,{childList:!0,subtree:!0});function d(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(a){if(a.ep)return;a.ep=!0;const l=d(a);fetch(a.href,l)}})();function Se(){const t=()=>"theme"in localStorage?localStorage.theme==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches,[n,d]=o.useState(t);return o.useEffect(()=>{document.documentElement.classList.toggle("dark",n),localStorage.theme=n?"dark":"light"},[n]),e.jsxs(v.button,{onClick:()=>d(!n),whileTap:{scale:.9},className:`relative flex items-center gap-2 px-3 py-2 rounded-full text-sm font-medium transition-all border ${n?"border-yellow-500 text-yellow-400 bg-gray-900 hover:bg-gray-800":"border-gray-300 text-gray-700 bg-white hover:bg-gray-100"} shadow-sm`,children:[e.jsx(A,{mode:"wait",initial:!1,children:n?e.jsxs(v.span,{initial:{rotate:-90,opacity:0},animate:{rotate:0,opacity:1},exit:{rotate:90,opacity:0},transition:{duration:.3},className:"flex items-center gap-2",children:[e.jsx(He,{className:"text-yellow-400"})," ",e.jsx("span",{children:"SÃ¡ng"})]},"sun"):e.jsxs(v.span,{initial:{rotate:90,opacity:0},animate:{rotate:0,opacity:1},exit:{rotate:-90,opacity:0},transition:{duration:.3},className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"text-blue-500"})," ",e.jsx("span",{children:"Tá»‘i"})]},"moon")}),n&&e.jsx(v.div,{className:"absolute inset-0 rounded-full bg-yellow-500/10 blur-md",initial:{opacity:0},animate:{opacity:[.2,.5,.2]},transition:{repeat:1/0,duration:2}})]})}function Rt(){const[t,n]=o.useState(!1),d=[{to:"/",icon:e.jsx(Xe,{}),label:"Tá»•ng quan"},{to:"/products",icon:e.jsx(H,{}),label:"Sáº£n pháº©m"},{to:"/customers",icon:e.jsx(ye,{}),label:"KhÃ¡ch hÃ ng"},{to:"/orders",icon:e.jsx(ie,{}),label:"ÄÆ¡n hÃ ng"},{to:"/orders/new",icon:e.jsx(Qe,{}),label:"Táº¡o Ä‘Æ¡n"},{to:"/stock",icon:e.jsx(ct,{}),label:"Kho"}];return e.jsxs(v.header,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},className:"fixed top-0 left-0 right-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-lg border-b border-yellow-200/40 dark:border-yellow-500/20 shadow-[0_2px_15px_rgba(242,201,76,0.1)] z-50",children:[e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between px-5 sm:px-6 py-3",children:[e.jsxs("div",{className:"flex items-center gap-2 select-none",children:[e.jsx("img",{src:"/icons/icon-192x192.png",alt:"RC Studio",className:"h-9 w-9 object-contain drop-shadow-[0_0_8px_#f2c94c]"}),e.jsx("span",{className:"font-extrabold text-lg bg-gradient-to-r from-[#f2c94c] to-[#d4a017] bg-clip-text text-transparent tracking-wide",children:"RC Studio"})]}),e.jsxs("div",{className:"hidden md:flex items-center gap-6",children:[e.jsx("nav",{className:"flex gap-6 text-sm font-medium",children:d.map(r=>e.jsxs(pe,{to:r.to,className:({isActive:a})=>`flex items-center gap-2 px-2 transition duration-300 ${a?"text-[#d4a017] font-semibold drop-shadow-[0_0_6px_#f2c94c]":"text-gray-700 dark:text-gray-300 hover:text-[#d4a017] hover:scale-[1.05]"}`,children:[r.icon,r.label]},r.to))}),e.jsx(Se,{})]}),e.jsx("button",{onClick:()=>n(!t),className:"md:hidden text-gray-700 dark:text-gray-300",children:t?e.jsx(G,{size:22}):e.jsx(dt,{size:22})})]}),e.jsx(A,{children:t&&e.jsxs(v.nav,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"md:hidden bg-white/95 dark:bg-gray-900/95 backdrop-blur-md border-t border-yellow-200/30 dark:border-yellow-500/20 flex flex-col items-start px-5 pb-4",children:[d.map(r=>e.jsxs(pe,{to:r.to,onClick:()=>n(!1),className:({isActive:a})=>`flex items-center gap-3 w-full py-3 text-sm font-medium border-b border-gray-100/10 ${a?"text-[#d4a017] font-semibold":"text-gray-700 dark:text-gray-300 hover:text-[#d4a017]"}`,children:[r.icon," ",r.label]},r.to)),e.jsx("div",{className:"mt-3",children:e.jsx(Se,{})})]})})]})}const nt=o.createContext(),te=()=>o.useContext(nt),Ut=({children:t})=>{const[n,d]=o.useState(!0);return e.jsx(nt.Provider,{value:{isNavVisible:n,setIsNavVisible:d},children:t})};function Ht(){const[t,n]=o.useState(!1),{isNavVisible:d}=te();o.useEffect(()=>{localStorage.getItem("theme")==="dark"&&(n(!0),document.documentElement.classList.add("dark"))},[]);const r=()=>{const l=!t;n(l),l?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},a=[{to:"/",icon:e.jsx(Xe,{}),label:"Tá»•ng quan"},{to:"/products",icon:e.jsx(H,{}),label:"Sáº£n pháº©m"},{to:"/customers",icon:e.jsx(ye,{}),label:"KhÃ¡ch hÃ ng"},{to:"/orders",icon:e.jsx(oe,{}),label:"ÄÆ¡n hÃ ng"},{to:"/stock",icon:e.jsx(xt,{}),label:"Kho"},{to:"/orders/new",icon:e.jsx(Qe,{}),label:"Táº¡o Ä‘Æ¡n"}];return e.jsxs("nav",{className:`
        fixed bottom-0 left-0 right-0 z-50 flex justify-around items-center
        bg-white/90 backdrop-blur-md border-t border-gray-300 
        py-2 shadow-[0_-2px_10px_rgba(0,0,0,0.06)]
        dark:bg-black/90 dark:border-yellow-700/30

        /* 3. THÃŠM CLASS Xá»¬ LÃ HIá»†U á»¨NG TRÆ¯á»¢T */
        transition-transform duration-300 ease-in-out
        ${d?"translate-y-0":"translate-y-full"}
      `,children:[a.map(l=>e.jsx(pe,{to:l.to,className:({isActive:m})=>`relative flex flex-col items-center text-xs font-medium transition-all duration-300 ${m?"text-yellow-600":"text-gray-600 hover:text-yellow-500"} dark:${m?"text-yellow-400":"text-gray-400 hover:text-yellow-200"}`,children:({isActive:m})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-lg relative",children:[l.icon,m&&e.jsx(v.span,{layoutId:"navGlow",className:"absolute inset-0 rounded-full bg-yellow-400/30 blur-md",initial:{opacity:0},animate:{opacity:1,scale:[1,1.25,1]},transition:{duration:1.3,ease:"easeInOut",repeat:1/0,repeatType:"reverse"}})]}),e.jsx("span",{className:"mt-0.5 tracking-tight",children:l.label}),m&&e.jsx(v.div,{className:`absolute -bottom-0.5 h-[2px] w-4/5 
                  bg-gradient-to-r from-transparent via-yellow-500 to-transparent rounded-full
                  dark:via-yellow-400
                  `,initial:{opacity:0,scaleX:0},animate:{opacity:1,scaleX:[0,1,0]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})]})},l.to)),e.jsx(v.button,{onClick:r,whileTap:{scale:.85},whileHover:{scale:1.1},className:`
          ml-2 w-11 h-11 flex items-center justify-center
          rounded-full bg-gray-200/70 border border-gray-300
          shadow-[0_0_10px_rgba(0,0,0,0.08)]
          backdrop-blur-md
          dark:bg-gray-700/50 dark:border-yellow-600/40
        `,children:e.jsx(A,{mode:"wait",children:t?e.jsx(v.div,{initial:{opacity:0,rotate:-90},animate:{opacity:1,rotate:0},exit:{opacity:0,rotate:90},transition:{duration:.25},children:e.jsx(Ge,{size:20,className:"text-yellow-500 dark:text-yellow-300"})},"moon"):e.jsx(v.div,{initial:{opacity:0,rotate:90},animate:{opacity:1,rotate:0},exit:{opacity:0,rotate:-90},transition:{duration:.25},children:e.jsx(He,{size:20,className:"text-yellow-600"})},"sun")})})]})}const S={success:(t,n={})=>K.success(t,{...n,style:{borderRadius:"12px",background:"#10b981",color:"#fff",fontSize:"0.95rem",fontWeight:"500",padding:"10px 16px",...n.style},iconTheme:{primary:"#fff",secondary:"#10b981"}}),error:(t,n={})=>K.error(t,{...n,style:{borderRadius:"12px",background:"#ef4444",color:"#fff",fontSize:"0.95rem",fontWeight:"500",padding:"10px 16px",...n.style},iconTheme:{primary:"#fff",secondary:"#ef4444"}}),info:(t,n={})=>K(t,{...n,style:{borderRadius:"12px",background:"#3b82f6",color:"#fff",fontSize:"0.95rem",fontWeight:"500",padding:"10px 16px",...n.style},icon:"â„¹ï¸"})},Gt="https://kho-quanao-backend-production.up.railway.app/api";async function P(t,n={}){const d=`${Gt}${t.startsWith("/")?t:`/${t}`}`;try{const r=await fetch(d,{headers:{"Content-Type":"application/json"},...n});if(!r.ok){const l=await r.text();throw console.error("âŒ API error:",r.status,l),S.error(`Lá»—i ${r.status}: ${l||"KhÃ´ng thá»ƒ káº¿t ná»‘i mÃ¡y chá»§"}`),new Error(l)}return await r.json()}catch(r){throw S.error("ðŸš« Lá»—i káº¿t ná»‘i server, vui lÃ²ng thá»­ láº¡i!"),r}}const Ce=t=>Number(t||0).toLocaleString("vi-VN")+"Ä‘";function Xt(){const[t,n]=o.useState({totalRevenue:0,totalOrders:0,totalCustomers:0,totalProducts:0,recentOrders:[],topProducts:[]}),[d,r]=o.useState(!0),{setIsNavVisible:a}=te(),l=o.useRef(0),m=x=>{const g=x.target.scrollTop;g<0||(g>l.current&&g>50?a(!1):g<l.current&&a(!0),l.current=g)};o.useEffect(()=>{a(!0),(async()=>{try{const g=await P("/orders"),i=await P("/customers"),f=await P("/products"),y=g.reduce((p,s)=>p+Number(s.total||0),0),k=[{name:"T2",uv:4e3},{name:"T3",uv:3e3},{name:"T4",uv:2e3},{name:"T5",uv:2780},{name:"T6",uv:1890},{name:"T7",uv:2390},{name:"CN",uv:3490}];n({totalRevenue:y,totalOrders:g.length,totalCustomers:i.length,totalProducts:f.length,recentOrders:g.slice(0,5),topProducts:f.slice(0,4),chartData:k})}catch(g){console.error("Lá»—i load dashboard:",g)}finally{r(!1)}})()},[]);const j=({title:x,value:g,icon:i,color:f,trend:y})=>e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white p-5 rounded-2xl shadow-sm border border-gray-100 flex items-start justify-between relative overflow-hidden group hover:shadow-md transition-all",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-sm font-medium mb-1",children:x}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800",children:g}),e.jsxs("div",{className:`flex items-center gap-1 text-xs font-bold mt-2 ${y>0?"text-green-500":"text-red-500"}`,children:[y>0?e.jsx(mt,{}):e.jsx(ut,{}),e.jsxs("span",{children:[Math.abs(y),"% so vá»›i thÃ¡ng trÆ°á»›c"]})]})]}),e.jsx("div",{className:`p-3 rounded-xl ${f} text-white shadow-lg transform group-hover:scale-110 transition-transform`,children:e.jsx(i,{size:24})}),e.jsx("div",{className:`absolute -bottom-4 -right-4 w-24 h-24 rounded-full opacity-10 ${f}`})]});return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        .hide-scroll-force::-webkit-scrollbar {
          display: none !important;
          width: 0 !important;
          height: 0 !important;
          background: transparent !important;
        }
        .hide-scroll-force {
          -ms-overflow-style: none !important;
          scrollbar-width: none !important;
        }
      `}),e.jsx("div",{className:"h-[100dvh] w-full bg-gray-50/50 flex flex-col overflow-hidden",children:e.jsx("div",{onScroll:m,className:"flex-1 overflow-y-auto hide-scroll-force p-4 md:p-6 pb-24 md:pb-10",children:d?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 animate-pulse",children:[[1,2,3,4].map(x=>e.jsx("div",{className:"h-32 bg-gray-200 rounded-2xl"},x)),e.jsx("div",{className:"md:col-span-2 lg:col-span-3 h-80 bg-gray-200 rounded-2xl mt-4"})]}):e.jsxs("div",{className:"space-y-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"md:hidden flex flex-col items-center justify-center mb-6 pt-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute -inset-2 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full blur opacity-30 animate-pulse"}),e.jsx("img",{src:"/icons/icon-192x192.png",alt:"App Logo",className:"relative h-20 w-auto object-contain drop-shadow-xl transform transition-transform duration-300",onError:x=>x.target.style.display="none"})]}),e.jsx("span",{className:"mt-4 text-sm font-extrabold uppercase tracking-[0.2em] bg-clip-text text-transparent bg-gradient-to-r from-yellow-500 to-orange-600 drop-shadow-sm",children:"Kho Quáº§n Ão Rinchan"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-2",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:["Xin chÃ o, Admin!",e.jsx("span",{className:"animate-bounce",children:"ðŸ‘‹"})]}),e.jsx("p",{className:"text-gray-500 text-sm mt-1 font-medium",children:"HÃ´m nay lÃ  má»™t ngÃ y tuyá»‡t vá»i Ä‘á»ƒ chá»‘t Ä‘Æ¡n! ðŸš€"})]}),e.jsxs("button",{className:"bg-gray-900 hover:bg-black text-white px-5 py-2.5 rounded-xl text-sm font-bold shadow-lg shadow-gray-500/20 transition-all flex items-center gap-2",children:[e.jsx(gt,{})," Xem bÃ¡o cÃ¡o"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6",children:[e.jsx(j,{title:"Tá»•ng Doanh Thu",value:Ce(t.totalRevenue),icon:ce,color:"bg-gradient-to-br from-blue-500 to-blue-600",trend:12.5}),e.jsx(j,{title:"ÄÆ¡n HÃ ng Má»›i",value:t.totalOrders,icon:oe,color:"bg-gradient-to-br from-purple-500 to-purple-600",trend:8.2}),e.jsx(j,{title:"KhÃ¡ch HÃ ng",value:t.totalCustomers,icon:ye,color:"bg-gradient-to-br from-orange-500 to-orange-600",trend:-2.4}),e.jsx(j,{title:"Sáº£n Pháº©m",value:t.totalProducts,icon:H,color:"bg-gradient-to-br from-emerald-500 to-emerald-600",trend:5.1})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-white p-5 rounded-2xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(ht,{className:"text-blue-500"})," Biá»ƒu Ä‘á»“ doanh thu"]}),e.jsxs("select",{className:"bg-gray-50 border-none text-xs font-bold text-gray-500 rounded-lg outline-none cursor-pointer",children:[e.jsx("option",{children:"7 ngÃ y qua"}),e.jsx("option",{children:"ThÃ¡ng nÃ y"})]})]}),e.jsx("div",{className:"h-[300px] w-full",children:e.jsx(Et,{width:"100%",height:"100%",children:e.jsxs(Vt,{data:t.chartData,children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorUv",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#3B82F6",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#3B82F6",stopOpacity:0})]})}),e.jsx(Mt,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),e.jsx(Ot,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#9CA3AF"},dy:10}),e.jsx(At,{axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#9CA3AF"},tickFormatter:x=>`${x/1e3}k`}),e.jsx(Kt,{contentStyle:{borderRadius:"12px",border:"none",boxShadow:"0 10px 15px -3px rgba(0, 0, 0, 0.1)"}}),e.jsx(qt,{type:"monotone",dataKey:"uv",stroke:"#3B82F6",strokeWidth:3,fillOpacity:1,fill:"url(#colorUv)"})]})})})]}),e.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-gray-800 mb-4 flex items-center gap-2",children:"ðŸ† Top Sáº£n Pháº©m"}),e.jsxs("div",{className:"space-y-4",children:[t.topProducts.map((x,g)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 rounded-xl transition-colors cursor-pointer",children:[e.jsx("div",{className:`
                          w-6 h-6 flex items-center justify-center rounded-full text-[10px] font-bold text-white
                          ${g===0?"bg-yellow-400":g===1?"bg-gray-400":g===2?"bg-orange-400":"bg-blue-100 text-blue-600"}
                        `,children:g+1}),e.jsx("img",{src:x.cover_image||x.image||"/no-image.png",className:"w-10 h-10 rounded-lg object-cover bg-gray-100",alt:"",onError:i=>i.target.src="/no-image.png"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-700 truncate",children:x.name}),e.jsxs("p",{className:"text-xs text-gray-400",children:[x.sold_count||0," Ä‘Ã£ bÃ¡n"]})]}),e.jsx("span",{className:"text-xs font-bold text-gray-800",children:Ce(x.price)})]},x.id)),t.topProducts.length===0&&e.jsx("div",{className:"text-center text-gray-400 text-xs py-10",children:"ChÆ°a cÃ³ dá»¯ liá»‡u"})]}),e.jsx("button",{className:"w-full mt-4 py-2 text-xs font-bold text-blue-600 bg-blue-50 rounded-lg hover:bg-blue-100 transition-colors",children:"Xem táº¥t cáº£ sáº£n pháº©m"})]})]})]})})})]})}const Qt="http://localhost:5000/api";function _e({load:t,onCancel:n}){const[d,r]=o.useState({sku:"",name:"",category:"",brand:"",cost_price:"",sale_price:"",stock:""}),[a,l]=o.useState(null),[m,j]=o.useState(null),[x,g]=o.useState(!1),i=k=>{const{name:p,value:s}=k.target;r(c=>({...c,[p]:s}))},f=k=>{const p=k.target.files[0];if(p){l(p);const s=URL.createObjectURL(p);j(s)}},y=async k=>{if(k.preventDefault(),!d.name)return K.error("Vui lÃ²ng nháº­p TÃªn sáº£n pháº©m!");try{g(!0);const p=new FormData;p.append("name",d.name),p.append("sku",d.sku),p.append("category",d.category),p.append("brand",d.brand),p.append("cost_price",Number(d.cost_price)||0),p.append("sale_price",Number(d.sale_price)||0),p.append("stock",Number(d.stock)||0),a&&p.append("image",a);const s=await fetch(`${Qt}/products`,{method:"POST",body:p}),c=await s.json();if(!s.ok)throw new Error(c?.message||"Lá»—i server");K.success(e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(je,{})," Táº¡o sáº£n pháº©m thÃ nh cÃ´ng!"]})),r({sku:"",name:"",category:"",brand:"",cost_price:"",sale_price:"",stock:""}),l(null),j(null),t&&await t(c.id)}catch(p){console.error(p),K.error("âŒ "+(p?.message||"KhÃ´ng thá»ƒ táº¡o sáº£n pháº©m"))}finally{g(!1)}};return e.jsxs(v.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`
        w-full bg-white dark:bg-gray-800 
        overflow-hidden
        md:rounded-2xl md:shadow-xl md:border md:border-gray-100 md:dark:border-gray-700 md:mb-6
      `,children:[e.jsxs("div",{className:"hidden md:flex bg-gray-50 dark:bg-gray-900 px-6 py-4 border-b border-gray-100 dark:border-gray-700 justify-between items-center",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-800 dark:text-gray-100 flex items-center gap-2",children:[e.jsx(re,{className:"text-blue-600"}),"ThÃªm sáº£n pháº©m má»›i"]}),n&&e.jsx("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:e.jsx(G,{size:24})})]}),e.jsxs("form",{onSubmit:y,className:"p-4 md:p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2",children:"HÃ¬nh áº£nh"}),e.jsxs("div",{className:"relative group w-full aspect-square bg-gray-50 dark:bg-gray-900 rounded-2xl border-2 border-dashed border-gray-300 dark:border-gray-600 hover:border-blue-400 transition-colors flex flex-col items-center justify-center cursor-pointer overflow-hidden",children:[m?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:m,alt:"Preview",className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 flex items-center justify-center transition-opacity",children:e.jsxs("span",{className:"text-white font-medium flex items-center gap-2",children:[e.jsx(Ne,{})," Äá»•i áº£nh"]})})]}):e.jsxs("div",{className:"text-gray-400 text-center p-4",children:[e.jsx(Ne,{size:40,className:"mx-auto mb-2 opacity-50"}),e.jsx("span",{className:"text-sm",children:"Báº¥m Ä‘á»ƒ táº£i áº£nh lÃªn"})]}),e.jsx("input",{type:"file",accept:"image/*",onChange:f,className:"absolute inset-0 opacity-0 cursor-pointer"})]})]}),e.jsxs("div",{className:"col-span-1 md:col-span-2 space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx("div",{className:"sm:col-span-2",children:e.jsx(W,{label:"TÃªn sáº£n pháº©m",name:"name",value:d.name,onChange:i,placeholder:"VD: Ão thun cotton...",icon:e.jsx(Ye,{}),required:!0})}),e.jsx("div",{children:e.jsx(W,{label:"MÃ£ SKU",name:"sku",value:d.sku,onChange:i,placeholder:"VD: AT-01"})})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 bg-blue-50/50 dark:bg-blue-900/20 p-4 rounded-xl border border-blue-100 dark:border-blue-800",children:[e.jsx("div",{className:"col-span-2 sm:col-span-1",children:e.jsx(W,{label:"GiÃ¡ bÃ¡n",name:"sale_price",type:"number",value:d.sale_price,onChange:i,placeholder:"0",icon:e.jsx(ce,{}),className:"font-bold text-blue-600 dark:text-blue-400",required:!0})}),e.jsx("div",{className:"col-span-1 sm:col-span-1",children:e.jsx(W,{label:"GiÃ¡ nháº­p",name:"cost_price",type:"number",value:d.cost_price,onChange:i,placeholder:"0"})}),e.jsx("div",{className:"col-span-1 sm:col-span-1",children:e.jsx(W,{label:"Tá»“n kho",name:"stock",type:"number",value:d.stock,onChange:i,placeholder:"0"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(W,{label:"Loáº¡i (Category)",name:"category",value:d.category,onChange:i,placeholder:"VD: Ão, Quáº§n..."}),e.jsx(W,{label:"ThÆ°Æ¡ng hiá»‡u",name:"brand",value:d.brand,onChange:i,placeholder:"VD: No Brand"})]})]})]}),e.jsxs("div",{className:"mt-8 pt-4 border-t border-gray-100 dark:border-gray-700 flex justify-end gap-3",children:[n&&e.jsx("button",{type:"button",onClick:n,className:"px-6 py-3 rounded-xl text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700 font-semibold transition",children:"Há»§y bá»"}),e.jsx("button",{type:"submit",disabled:x,className:`
                w-full md:w-auto px-8 py-3 rounded-xl 
                bg-blue-600 text-white font-bold 
                shadow-lg shadow-blue-200 dark:shadow-none
                hover:bg-blue-700 hover:shadow-blue-300 transition-all 
                flex items-center justify-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed
            `,children:x?e.jsx(e.Fragment,{children:"â³ Äang xá»­ lÃ½..."}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{})," LÆ°u sáº£n pháº©m"]})})]})]})]})}const W=({label:t,icon:n,className:d="",required:r,...a})=>e.jsxs("div",{className:"flex flex-col gap-1.5",children:[e.jsxs("label",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase flex items-center gap-1",children:[t," ",r&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[n&&e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400",children:n}),e.jsx("input",{...a,className:`
            w-full bg-white dark:bg-gray-900 
            border border-gray-200 dark:border-gray-700 rounded-lg 
            px-3 py-2.5 text-sm dark:text-white
            outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-100 dark:focus:ring-blue-900
            transition-all placeholder:text-gray-300 
            ${n?"pl-9":""} ${d}
        `})]})]}),ne="https://placehold.co/400x400?text=No+Image",Te=t=>(Number(t||0).toLocaleString("vi-VN")||0)+"Ä‘";function Fe({filtered:t,selected:n,setSelected:d,listLoading:r,onRestock:a,viewType:l="grid",gridCols:m=3}){const j={2:"grid-cols-2",3:"grid-cols-2 md:grid-cols-3",4:"grid-cols-2 md:grid-cols-3 lg:grid-cols-4",5:"grid-cols-2 md:grid-cols-4 lg:grid-cols-5"},x=({p:i})=>{const f=n?.id===i.id,y=Number(i.stock);return e.jsxs(v.div,{layout:!0,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},whileTap:{scale:.98},onClick:()=>d(i),className:`
          group relative flex flex-col bg-white dark:bg-gray-800 overflow-hidden cursor-pointer transition-all duration-300

          /* Mobile: VuÃ´ng gÃ³c, border má»ng */
          rounded-none border-b border-r border-gray-100 dark:border-gray-800 

          /* PC: Card ná»•i, bo gÃ³c */
          md:rounded-2xl md:border md:shadow-sm md:hover:shadow-xl md:hover:border-blue-200

          ${f?"z-10 ring-2 ring-blue-500 md:border-blue-500":""}
        `,children:[e.jsxs("div",{className:"aspect-square w-full bg-gray-50 dark:bg-gray-900 relative overflow-hidden",children:[e.jsx("img",{src:i.cover_image||ne,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-110 transform-gpu will-change-transform backface-hidden",onError:k=>k.target.src=ne,alt:i.name,loading:"lazy",decoding:"async"}),e.jsx("div",{className:"absolute top-2 left-2",children:y===0?e.jsx("span",{className:"bg-red-600 text-white text-[9px] font-bold px-1.5 py-0.5 rounded shadow-sm",children:"Háº¾T"}):y<=5?e.jsxs("span",{className:"bg-orange-500 text-white text-[9px] font-bold px-1.5 py-0.5 rounded shadow-sm",children:["SL: ",y]}):null}),e.jsx("div",{className:"absolute bottom-1 right-1 bg-white/90 dark:bg-gray-800/90 text-blue-700 dark:text-blue-400 text-[10px] font-bold px-1.5 py-0.5 rounded shadow-sm",children:Te(i.sale_price||i.price)})]}),e.jsx("div",{className:"p-2 flex flex-col flex-1",children:e.jsx("h4",{className:"text-xs font-medium text-gray-700 dark:text-gray-100 line-clamp-2 leading-tight mb-1 group-hover:text-blue-600",children:i.name})})]})},g=({p:i})=>{const f=n?.id===i.id,y=Number(i.stock);return e.jsxs(v.div,{layout:!0,initial:{opacity:0},animate:{opacity:1},onClick:()=>d(i),className:`
          group flex gap-3 cursor-pointer transition-all duration-200

          /* === MOBILE STYLES: PHáº²NG & TRÃ€N VIá»€N === */
          w-full
          p-3
          bg-white dark:bg-gray-900
          border-b border-gray-100 dark:border-gray-800

          /* === PC STYLES === */
          md:rounded-xl md:border md:border-gray-100 md:dark:border-gray-700
          md:mb-2 md:p-3 md:shadow-sm md:hover:shadow-md md:hover:border-blue-300
          md:bg-white md:dark:bg-gray-800

          ${f?"bg-blue-50 dark:bg-blue-900/10":"active:bg-gray-50 dark:active:bg-gray-800"}
        `,children:[e.jsxs("div",{className:"w-[70px] h-[70px] flex-shrink-0 bg-gray-100 rounded-lg overflow-hidden border border-gray-100 dark:border-gray-700 relative",children:[e.jsx("img",{src:i.cover_image||ne,className:"w-full h-full object-cover transform-gpu will-change-transform backface-hidden",onError:k=>k.target.src=ne,alt:i.name,loading:"lazy",decoding:"async"}),y===0&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center",children:e.jsx("span",{className:"text-white text-[10px] font-bold",children:"Háº¾T"})})]}),e.jsxs("div",{className:"flex-1 flex flex-col justify-center min-w-0 py-0.5",children:[e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-[15px] font-semibold text-gray-900 dark:text-gray-100 line-clamp-2 leading-snug group-hover:text-blue-600",children:i.name}),e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 flex items-center gap-2",children:e.jsx("span",{className:"font-mono bg-gray-100 dark:bg-gray-800 px-1 rounded",children:i.sku||"---"})})]}),e.jsx("div",{className:"text-right shrink-0",children:e.jsx("div",{className:"text-[15px] font-bold text-blue-600",children:Te(i.sale_price||i.price)})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:y===0?e.jsx("span",{className:"text-[11px] text-red-500 font-medium flex items-center gap-1 bg-red-50 px-1.5 py-0.5 rounded",children:"Háº¿t hÃ ng"}):e.jsxs("span",{className:`text-[11px] font-medium px-1.5 py-0.5 rounded ${y<=5?"text-orange-600 bg-orange-50":"text-green-600 bg-green-50"}`,children:["Kho: ",y]})}),y<=5&&e.jsx("button",{onClick:k=>{k.stopPropagation(),a(i)},className:"text-[11px] font-bold text-blue-600 bg-blue-50 px-3 py-1 rounded-full hover:bg-blue-100 active:scale-95 transition-all",children:"+ Nháº­p"})]})]})]})};return r?e.jsxs("div",{className:"py-20 flex flex-col items-center justify-center text-gray-400 gap-3",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-xs",children:"Äang táº£i..."})]}):!t||t.length===0?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400 py-10",children:[e.jsx(X,{size:48,className:"mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:"KhÃ´ng cÃ³ sáº£n pháº©m nÃ o"})]}):e.jsx("div",{className:l==="grid"?`grid ${j[m]||"grid-cols-2 md:grid-cols-3"} gap-0 md:gap-4 bg-gray-200 dark:bg-gray-900 md:bg-transparent pb-0`:"flex flex-col w-full pb-0",children:e.jsx(A,{mode:"popLayout",children:t.map(i=>l==="grid"?e.jsx(x,{p:i},i.id):e.jsx(g,{p:i},i.id))})})}function Yt({productId:t,editItem:n,onClose:d,onSaved:r}){const[a,l]=o.useState({size:n?.size||"",color:n?.color||"",stock:n?.stock||0}),[m,j]=o.useState(!1),x=async()=>{if(!a.size||!a.color)return S.error("âš ï¸ Vui lÃ²ng nháº­p Size vÃ  MÃ u sáº¯c");j(!0);try{const g={product_id:t,size:a.size,color:a.color,stock:Number(a.stock)||0};n?(await P(`/variants/${n.id}`,{method:"PUT",body:JSON.stringify(g)}),S.success("ðŸ’¾ ÄÃ£ cáº­p nháº­t biáº¿n thá»ƒ")):(await P("/variants",{method:"POST",body:JSON.stringify(g)}),S.success("âœ… ÄÃ£ thÃªm biáº¿n thá»ƒ má»›i")),r()}catch{S.error("âŒ Lá»—i khi lÆ°u biáº¿n thá»ƒ")}finally{j(!1)}};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"p-5 bg-gray-50 dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 shadow-sm space-y-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase flex items-center gap-1",children:[e.jsx(re,{})," KÃ­ch thÆ°á»›c (Size)"]}),e.jsx("input",{placeholder:"VD: S, M, L, 29, 30...",value:a.size,onChange:g=>l({...a,size:g.target.value}),className:`
              w-full px-4 py-3 rounded-xl 
              bg-white dark:bg-gray-900 
              border border-gray-300 dark:border-gray-600 
              focus:ring-2 focus:ring-blue-500 outline-none transition
            `})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase flex items-center gap-1",children:[e.jsx(bt,{})," MÃ u sáº¯c"]}),e.jsx("input",{placeholder:"VD: Äen, Tráº¯ng, Xanh...",value:a.color,onChange:g=>l({...a,color:g.target.value}),className:`
              w-full px-4 py-3 rounded-xl 
              bg-white dark:bg-gray-900 
              border border-gray-300 dark:border-gray-600 
              focus:ring-2 focus:ring-blue-500 outline-none transition
            `})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase flex items-center gap-1",children:[e.jsx(H,{})," Tá»“n kho ban Ä‘áº§u"]}),e.jsx("input",{type:"number",placeholder:"0",value:a.stock,onChange:g=>l({...a,stock:g.target.value}),className:`
              w-full px-4 py-3 rounded-xl 
              bg-white dark:bg-gray-900 
              border border-gray-300 dark:border-gray-600 
              focus:ring-2 focus:ring-blue-500 outline-none transition font-mono
            `})]})]}),e.jsx("button",{onClick:x,disabled:m,className:`
          w-full py-3.5 rounded-xl 
          bg-blue-600 hover:bg-blue-700 text-white font-bold 
          shadow-lg shadow-blue-200 dark:shadow-none 
          active:scale-95 transition-all
          flex items-center justify-center gap-2
          disabled:opacity-70 disabled:cursor-not-allowed
        `,children:m?e.jsx(e.Fragment,{children:"â³ Äang lÆ°u..."}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"text-lg"}),n?"LÆ°u thay Ä‘á»•i":"ThÃªm biáº¿n thá»ƒ"]})}),e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:d,className:"text-sm text-gray-400 hover:text-gray-600 underline decoration-dashed",children:"Há»§y bá»"})})]})}function Jt({productId:t,onClose:n,onSaved:d}){const[r,a]=o.useState(""),[l,m]=o.useState(""),[j,x]=o.useState(0),g=o.useMemo(()=>r.split(",").map(s=>s.trim()).filter(Boolean),[r]),i=o.useMemo(()=>l.split(",").map(s=>s.trim()).filter(Boolean),[l]),f=o.useMemo(()=>{let s=[];return g.forEach(c=>i.forEach(u=>s.push({size:c,color:u}))),s},[g,i]),y=async()=>{if(!g.length||!i.length)return S.error("âš ï¸ HÃ£y nháº­p Ã­t nháº¥t 1 size vÃ  1 mÃ u");try{const s=await P("/variants/bulk",{method:"POST",body:JSON.stringify({product_id:t,sizes:g,colors:i,default_stock:Number(j)||0})});S.success(`âœ¨ ${s.message}`),d(),n()}catch{S.error("âŒ Lá»—i táº¡o biáº¿n thá»ƒ")}},k=(s,c)=>{c&&(s==="size"&&!g.includes(c)&&a(u=>u?u+", "+c:c),s==="color"&&!i.includes(c)&&m(u=>u?u+", "+c:c))},p=(s,c)=>{s==="size"?a(g.filter(u=>u!==c).join(", ")):m(i.filter(u=>u!==c).join(", "))};return e.jsxs(v.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{duration:.25,ease:"easeOut"},className:`
        fixed inset-0 z-[999999] 
        bg-white dark:bg-gray-900 
        overflow-y-auto
      `,children:[e.jsxs("div",{className:`
          sticky top-0 z-10 
          bg-white/80 dark:bg-gray-900/80 
          backdrop-blur-xl 
          border-b border-gray-200 dark:border-gray-700
          flex items-center gap-3
          px-4 py-3
        `,children:[e.jsx("button",{onClick:n,className:"text-gray-700 dark:text-gray-300 hover:text-indigo-600",children:e.jsx(Q,{size:26})}),e.jsxs("h3",{className:"font-semibold text-lg flex items-center gap-2",children:[e.jsx(re,{className:"text-indigo-500"}),"Táº¡o biáº¿n thá»ƒ hÃ ng loáº¡t"]})]}),e.jsxs("div",{className:"p-5 space-y-6",children:[e.jsxs("div",{className:"p-4 rounded-2xl bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 shadow-sm",children:[e.jsx("p",{className:"text-sm font-semibold mb-2",children:"Size"}),e.jsx("input",{placeholder:"S, M, L...",value:r,onChange:s=>a(s.target.value),className:`
              w-full px-3 py-2 rounded-xl 
              bg-white dark:bg-gray-900 
              border border-gray-300 dark:border-gray-700 
              text-sm outline-none
            `}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:["S","M","L","XL","XXL"].map(s=>e.jsx("button",{onClick:()=>k("size",s),className:`
                  px-3 py-1.5 rounded-xl text-xs 
                  bg-white dark:bg-gray-700 
                  border border-gray-300 dark:border-gray-600
                  hover:bg-indigo-600 hover:text-white 
                  transition
                `,children:s},s))}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:g.map(s=>e.jsxs("div",{className:`
                  px-3 py-1 rounded-xl 
                  bg-indigo-100 text-indigo-700 
                  dark:bg-indigo-600 dark:text-white 
                  flex items-center gap-1 text-xs
                `,children:[s,e.jsx("span",{onClick:()=>p("size",s),className:"cursor-pointer opacity-70 hover:opacity-100",children:"Ã—"})]},s))})]}),e.jsxs("div",{className:"p-4 rounded-2xl bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 shadow-sm",children:[e.jsx("p",{className:"text-sm font-semibold mb-2",children:"MÃ u sáº¯c"}),e.jsx("input",{placeholder:"Äá», Äen, Tráº¯ng...",value:l,onChange:s=>m(s.target.value),className:`
              w-full px-3 py-2 rounded-xl 
              bg-white dark:bg-gray-900 
              border border-gray-300 dark:border-gray-700 
              text-sm outline-none
            `}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:["Äá»","Äen","Tráº¯ng","Xanh","VÃ ng"].map(s=>e.jsx("button",{onClick:()=>k("color",s),className:`
                  px-3 py-1.5 rounded-xl text-xs 
                  bg-white dark:bg-gray-700 
                  border border-gray-300 dark:border-gray-600
                  hover:bg-indigo-600 hover:text-white 
                  transition
                `,children:s},s))}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:i.map(s=>e.jsxs("div",{className:`
                  px-3 py-1 rounded-xl 
                  bg-rose-100 text-rose-700 
                  dark:bg-rose-600 dark:text-white 
                  flex items-center gap-1 text-xs
                `,children:[s,e.jsx("span",{onClick:()=>p("color",s),className:"cursor-pointer opacity-70 hover:opacity-100",children:"Ã—"})]},s))})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-300",children:"Tá»“n kho máº·c Ä‘á»‹nh"}),e.jsx("input",{type:"number",placeholder:"VD: 10",value:j,onChange:s=>x(s.target.value),className:`
              w-full px-3 py-2 rounded-xl 
              bg-gray-50 dark:bg-gray-800 
              border border-gray-300 dark:border-gray-700 
              text-sm outline-none
            `})]}),e.jsxs("div",{className:"p-4 rounded-2xl bg-gray-50 dark:bg-gray-800 border border-gray-300 dark:border-gray-700 space-y-2 max-h-48 overflow-auto shadow-sm",children:[e.jsxs("p",{className:"flex items-center gap-2 font-semibold text-sm",children:[e.jsx(Ye,{className:"text-indigo-500"}),"Sáº½ táº¡o ",f.length," biáº¿n thá»ƒ"]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:f.map((s,c)=>e.jsxs("div",{className:`
                  px-3 py-2 rounded-xl 
                  bg-white dark:bg-gray-900 
                  border border-gray-300 dark:border-gray-700
                  text-xs shadow-sm
                `,children:[e.jsx("strong",{children:s.size})," â€¢ ",s.color]},c))})]})]}),e.jsxs("div",{className:`
          sticky bottom-0 
          bg-white/90 dark:bg-gray-900/90 
          backdrop-blur-xl 
          border-t border-gray-300 dark:border-gray-700
          p-4 flex justify-end gap-3
        `,children:[e.jsx("button",{onClick:n,className:`
            px-5 py-2 rounded-xl 
            bg-gray-200 dark:bg-gray-700 
            text-gray-900 dark:text-gray-100
          `,children:"Há»§y"}),e.jsx("button",{onClick:y,className:`
            px-6 py-2 rounded-xl 
            bg-gradient-to-r from-indigo-600 to-indigo-500 
            text-white font-semibold shadow-lg
          `,children:"Táº¡o biáº¿n thá»ƒ"})]})]})}const Le=({children:t})=>typeof document>"u"?null:Ze.createPortal(t,document.body);function Wt({productId:t}){const[n,d]=o.useState([]),[r,a]=o.useState(!1),[l,m]=o.useState(!1),[j,x]=o.useState(!1),[g,i]=o.useState(null),[f,y]=o.useState("list"),k=async()=>{if(t){a(!0);try{const s=await P(`/variants/by-product/${t}`);d(s)}catch{S.error("âŒ KhÃ´ng thá»ƒ táº£i danh sÃ¡ch biáº¿n thá»ƒ")}finally{a(!1)}}};o.useEffect(()=>{k()},[t]);const p=async s=>{if(await S.confirm("ðŸ—‘ï¸ Báº¡n cÃ³ cháº¯c muá»‘n xoÃ¡ biáº¿n thá»ƒ nÃ y?"))try{await P(`/variants/${s}`,{method:"DELETE"}),S.success("ðŸ—‘ï¸ ÄÃ£ xoÃ¡ biáº¿n thá»ƒ"),k()}catch{S.error("âŒ Lá»—i khi xoÃ¡ biáº¿n thá»ƒ")}};return e.jsxs(e.Fragment,{children:[e.jsxs(v.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:`
          bg-white/90 dark:bg-gray-900/90 
          p-4 sm:p-6 rounded-2xl 
          border shadow-xl space-y-5
          backdrop-blur-xl
        `,children:[e.jsx("div",{className:"md:hidden flex justify-between gap-2 bg-gray-100 p-1 rounded-xl shadow-inner",children:[{id:"list",label:"Danh sÃ¡ch",icon:se},{id:"add",label:"ThÃªm",icon:de},{id:"bulk",label:"Nhiá»u",icon:ae}].map(s=>e.jsxs("button",{onClick:()=>{y(s.id),s.id==="add"&&(i(null),m(!0)),s.id==="bulk"&&x(!0)},className:`
                flex-1 flex flex-col items-center py-2 rounded-xl text-xs font-semibold
                ${f===s.id?"bg-white shadow text-blue-600":"text-gray-500"}
              `,children:[e.jsx(s.icon,{className:"text-lg mb-1"}),s.label]},s.id))}),e.jsxs("div",{className:"hidden md:flex items-center justify-between",children:[e.jsxs("h3",{className:"font-bold text-xl flex items-center gap-2 text-gray-800 dark:text-gray-200",children:[e.jsx(X,{className:"text-indigo-500"})," Biáº¿n thá»ƒ sáº£n pháº©m"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>{i(null),m(!0)},className:"px-3 py-1.5 bg-indigo-600 text-white text-sm rounded-lg flex items-center gap-1 shadow",children:[e.jsx(de,{})," ThÃªm"]}),e.jsxs("button",{onClick:()=>x(!0),className:"px-3 py-1.5 bg-indigo-50 text-indigo-600 border text-sm rounded-lg flex items-center gap-1",children:[e.jsx(ae,{})," Táº¡o nhiá»u"]}),e.jsxs("button",{onClick:k,className:"px-3 py-1.5 bg-gray-100 border text-gray-700 text-sm rounded-lg flex items-center gap-1",children:[e.jsx(ve,{})," LÃ m má»›i"]})]})]}),f==="list"&&e.jsx(e.Fragment,{children:r?e.jsx("div",{className:"text-center py-5 text-gray-500",children:"â³ Äang táº£i..."}):n.length===0?e.jsx("div",{className:"text-center py-5 text-gray-500 italic",children:"ChÆ°a cÃ³ biáº¿n thá»ƒ nÃ o."}):e.jsx("div",{className:"grid grid-cols-2 gap-3",children:n.map(s=>e.jsxs(v.div,{whileTap:{scale:.97},className:`
                      p-4 rounded-2xl bg-white dark:bg-gray-800 
                      border border-gray-200 dark:border-gray-700 
                      shadow-md space-y-2
                    `,children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:s.size}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-lg bg-gray-100 dark:bg-gray-700 text-gray-600 dark:text-gray-300",children:s.color})]}),e.jsxs("div",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Tá»“n kho:"," ",e.jsx("span",{className:"font-bold text-gray-900 dark:text-gray-100",children:s.stock})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-1",children:[e.jsx("button",{onClick:()=>{i(s),m(!0)},className:"text-blue-600 dark:text-blue-400 text-lg",children:e.jsx(Je,{})}),e.jsx("button",{onClick:()=>p(s.id),className:"text-red-600 dark:text-red-400 text-lg",children:e.jsx(We,{})})]})]},s.id))})})]}),e.jsx(A,{children:l&&e.jsx(Le,{children:e.jsxs(v.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{duration:.25},className:"fixed inset-0 bg-white dark:bg-gray-900 z-[9999999] overflow-y-auto flex flex-col",children:[e.jsxs("div",{className:"p-4 flex items-center gap-3 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-900 z-10 shrink-0",children:[e.jsx("button",{onClick:()=>m(!1),className:"text-gray-700 dark:text-gray-200",children:e.jsx(Q,{size:22})}),e.jsx("p",{className:"font-semibold",children:g?"Sá»­a biáº¿n thá»ƒ":"ThÃªm biáº¿n thá»ƒ"})]}),e.jsx("div",{className:"p-4 pb-40 flex-1 overflow-y-auto",children:e.jsx(Yt,{productId:t,editItem:g,onClose:()=>m(!1),onSaved:()=>{k(),m(!1)}})})]})})}),e.jsx(A,{children:j&&e.jsx(Le,{children:e.jsxs(v.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{duration:.25},className:"fixed inset-0 bg-white dark:bg-gray-900 z-[9999999] overflow-y-auto flex flex-col",children:[e.jsxs("div",{className:"p-4 flex items-center gap-3 border-b border-gray-200 dark:border-gray-700 sticky top-0 bg-white dark:bg-gray-900 z-10 shrink-0",children:[e.jsx("button",{onClick:()=>x(!1),className:"text-gray-700 dark:text-gray-200",children:e.jsx(Q,{size:22})}),e.jsx("p",{className:"font-semibold",children:"Táº¡o nhiá»u biáº¿n thá»ƒ"})]}),e.jsx("div",{className:"p-4 pb-40 flex-1 overflow-y-auto",children:e.jsx(Jt,{productId:t,onClose:()=>x(!1),onSaved:()=>{k(),x(!1)}})})]})})})]})}const Zt="http://localhost:5000/api",ze=t=>t?String(t).replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,"."):"0";function $e({selected:t,setSelected:n,load:d}){const[r,a]=o.useState({sku:"",name:"",category:"",brand:"",cost_price:"",sale_price:"",stock:""}),[l,m]=o.useState([]),[j,x]=o.useState([]),[g,i]=o.useState(!1),[f,y]=o.useState(!1);o.useEffect(()=>{t&&(a({sku:t.sku||"",name:t.name||"",category:t.category||"",brand:t.brand||"",cost_price:parseInt(t.cost_price||t.import_price||0),sale_price:parseInt(t.sale_price||t.price||0),stock:parseInt(t.stock||0)}),m([]),x([]))},[t]);const k=c=>{const u=Array.from(c.target.files||[]),C=u.map(N=>URL.createObjectURL(N));m(N=>[...N,...u]),x(N=>[...N,...C])},p=c=>{m(u=>u.filter((C,N)=>N!==c)),x(u=>u.filter((C,N)=>N!==c))},s=async c=>{c.preventDefault(),i(!0);try{const u=new FormData;Object.entries(r).forEach(([w,T])=>{if(["cost_price","sale_price","stock"].includes(w)){const _=Number(String(T).replace(/\./g,""))||0;u.append(w,_)}else u.append(w,T)}),l.forEach(w=>u.append("images",w));const C=localStorage.getItem("token"),N=await fetch(`${Zt}/products/${t.id}`,{method:"PUT",headers:{...C&&{Authorization:`Bearer ${C}`}},body:u}),z=await N.json();if(!N.ok)throw new Error(z.message||"Lá»—i khi cáº­p nháº­t");K.success("ðŸŽ‰ ÄÃ£ cáº­p nháº­t sáº£n pháº©m!"),await d(t.id),n({...t,...r}),m([]),x([])}catch(u){console.error(u),K.error("âŒ "+u.message)}finally{i(!1)}};return t?e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        *::-webkit-scrollbar { display: none !important; }
        * { -ms-overflow-style: none !important; scrollbar-width: none !important; }
      `}),e.jsx(v.div,{initial:{opacity:0,y:14},animate:{opacity:1,y:0},transition:{duration:.25},className:`
          w-full h-full overflow-y-auto
          p-4 md:p-0 
          bg-white dark:bg-gray-900
          md:bg-transparent md:dark:bg-transparent
          pb-24 md:pb-0
        `,children:e.jsxs("div",{className:`
           md:bg-white md:dark:bg-gray-800 
           md:rounded-3xl md:shadow-[0_8px_30px_rgb(0,0,0,0.12)] 
           md:border md:border-gray-100 md:dark:border-gray-700
           md:p-8 space-y-6
        `,children:[e.jsxs("div",{className:"hidden md:flex items-center justify-between pb-4 border-b border-gray-200 dark:border-gray-700",children:[e.jsxs("h4",{className:"font-bold text-gray-900 dark:text-white text-xl flex items-center gap-2",children:[e.jsx(Je,{className:"text-blue-500"})," Chi tiáº¿t sáº£n pháº©m"]}),e.jsxs("div",{className:"text-xs text-gray-400 bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:["ID: #",t.id]})]}),e.jsxs("form",{onSubmit:s,className:"grid grid-cols-1 lg:grid-cols-[300px_1fr] gap-8",children:[e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-bold text-gray-700 dark:text-gray-300 mb-2 block",children:"áº¢nh Ä‘áº¡i diá»‡n"}),e.jsxs("div",{className:"relative w-full aspect-square rounded-2xl overflow-hidden border border-gray-200 dark:border-gray-700 shadow-sm group",children:[e.jsx("img",{src:t.cover_image||"/no-image.png",className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105 transform-gpu will-change-transform backface-hidden",onError:c=>c.target.src="/no-image.png",alt:"Cover",loading:"lazy",decoding:"async"}),e.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("span",{className:"text-white text-xs font-medium px-2 py-1 rounded bg-black/50",children:"áº¢nh gá»‘c"})})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"text-sm font-bold text-gray-700 dark:text-gray-300 mb-2 flex items-center gap-2",children:[e.jsx(pt,{})," ThÃªm áº£nh má»›i"]}),j.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-3",children:j.map((c,u)=>e.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden border border-blue-200",children:[e.jsx("img",{src:c,className:"w-full h-full object-cover transform-gpu will-change-transform backface-hidden",alt:"new"}),e.jsx("button",{type:"button",onClick:()=>p(u),className:"absolute top-0.5 right-0.5 bg-red-500 text-white rounded-full p-0.5 shadow hover:bg-red-600",children:e.jsx(G,{size:12})})]},u))}),e.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-xl cursor-pointer bg-gray-50 dark:bg-gray-800/50 hover:bg-blue-50 dark:hover:bg-gray-800 transition group",children:[e.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6 text-gray-500 group-hover:text-blue-500",children:[e.jsx(ft,{className:"w-6 h-6 mb-1"}),e.jsx("p",{className:"text-xs",children:"Chá»n áº£nh"})]}),e.jsx("input",{type:"file",className:"hidden",multiple:!0,accept:"image/*",onChange:k})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsx(Z,{label:"TÃªn sáº£n pháº©m",value:r.name,onChange:c=>a({...r,name:c})}),e.jsx(Z,{label:"MÃ£ SKU",value:r.sku,onChange:c=>a({...r,sku:c})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[e.jsx(Z,{label:"Danh má»¥c",value:r.category,onChange:c=>a({...r,category:c})}),e.jsx(Z,{label:"ThÆ°Æ¡ng hiá»‡u",value:r.brand,onChange:c=>a({...r,brand:c})})]}),e.jsxs("div",{className:"p-5 bg-yellow-50 dark:bg-yellow-900/10 rounded-2xl border border-yellow-200 dark:border-yellow-800 grid grid-cols-2 md:grid-cols-3 gap-6",children:[e.jsx(Z,{label:"GiÃ¡ nháº­p (Vá»‘n)",value:ze(r.cost_price),onChange:c=>{const u=c.replace(/\./g,"");isNaN(u)||a({...r,cost_price:u})}}),e.jsx(Z,{label:"GiÃ¡ bÃ¡n (Láº»)",value:ze(r.sale_price),onChange:c=>{const u=c.replace(/\./g,"");isNaN(u)||a({...r,sale_price:u})}}),e.jsx("div",{className:"col-span-2 md:col-span-1",children:e.jsx(Z,{label:"Tá»“n kho",value:r.stock,onChange:c=>a({...r,stock:c.replace(/\D/g,"")}),icon:e.jsx(H,{})})})]}),e.jsxs("div",{className:"pt-4 flex flex-col gap-3",children:[e.jsx("button",{type:"button",onClick:()=>y(!0),className:"w-full py-3.5 rounded-xl border-2 border-indigo-100 dark:border-indigo-900 text-indigo-600 dark:text-indigo-400 font-bold hover:bg-indigo-50 dark:hover:bg-indigo-900/30 transition flex items-center justify-center gap-2",children:"ðŸŽ¨ Quáº£n lÃ½ Biáº¿n thá»ƒ (Size/MÃ u)"}),e.jsx(v.button,{whileTap:{scale:.98},disabled:g,type:"submit",className:"w-full py-3.5 rounded-xl bg-gradient-to-r from-blue-600 to-blue-700 text-white font-bold shadow-lg shadow-blue-200 dark:shadow-none hover:shadow-xl hover:from-blue-700 hover:to-blue-800 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Äang lÆ°u..."]}):e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"text-lg"})," LÆ°u thay Ä‘á»•i"]})})]})]})]})]})},t.id),e.jsx(A,{children:f&&e.jsxs(v.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"fixed inset-0 z-[99999] bg-white dark:bg-gray-900 shadow-2xl flex flex-col",children:[e.jsxs("div",{className:"sticky top-0 z-50 p-4 bg-white dark:bg-gray-900 border-b dark:border-gray-800 flex items-center gap-3 shadow-sm",children:[e.jsx("button",{onClick:()=>y(!1),className:"p-2 -ml-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition",children:e.jsx(Q,{size:28})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Quáº£n lÃ½ biáº¿n thá»ƒ"}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:t.name})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 pb-24 bg-gray-50 dark:bg-gray-900",children:e.jsx("div",{className:"max-w-4xl mx-auto",children:e.jsx(Wt,{productId:t.id})})})]})})]}):null}function Z({label:t,value:n,onChange:d,type:r="text",icon:a=null}){return e.jsxs("div",{className:"flex flex-col gap-2 group relative",children:[e.jsxs("label",{className:"text-xs font-bold text-gray-500 dark:text-gray-400 uppercase tracking-wide group-focus-within:text-blue-500 transition-colors flex items-center gap-1",children:[a&&e.jsx("span",{className:"text-lg",children:a}),t]}),e.jsx("input",{type:r,className:"w-full px-4 py-3 rounded-xl bg-gray-50 dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 focus:ring-2 focus:ring-blue-500 focus:border-transparent focus:bg-white dark:focus:bg-gray-800 outline-none transition-all font-medium text-gray-800 dark:text-gray-100 placeholder-gray-400",value:n,placeholder:`Nháº­p ${t.toLowerCase()}...`,onChange:l=>d(l.target.value)})]})}const lt="http://localhost:5000/api",it=({children:t})=>typeof document>"u"?null:Ze.createPortal(t,document.body);function es({open:t,setOpen:n,product:d,qty:r,setQty:a,reload:l}){const[m,j]=o.useState(!1),x=()=>{n(!1),a("")},g=async()=>{if(!r||Number(r)<=0)return K.error("âš ï¸ Vui lÃ²ng nháº­p sá»‘ lÆ°á»£ng há»£p lá»‡!");try{j(!0);const i=localStorage.getItem("token"),f=await fetch(`${lt}/stock/import`,{method:"POST",headers:{"Content-Type":"application/json",...i&&{Authorization:`Bearer ${i}`}},body:JSON.stringify({product_id:d.id,quantity:Number(r)})}),y=await f.json();if(!f.ok)throw new Error(y.message||"Lá»—i nháº­p hÃ ng");K.success(e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(et,{className:"text-green-500"}),e.jsxs("span",{children:["ÄÃ£ nháº­p thÃªm ",e.jsx("b",{children:r})," sp cho ",e.jsx("b",{children:d.name})]})]})),await l(d.id),x()}catch(i){console.error(i),K.error("âŒ "+(i.message||"KhÃ´ng thá»ƒ nháº­p hÃ ng"))}finally{j(!1)}};return e.jsx(it,{children:e.jsx(A,{children:t&&d&&e.jsx(v.div,{className:"fixed inset-0 z-[99999] flex items-end sm:items-center justify-center bg-black/60 backdrop-blur-sm p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x,children:e.jsxs(v.div,{onClick:i=>i.stopPropagation(),initial:{y:50,opacity:0,scale:.95},animate:{y:0,opacity:1,scale:1},exit:{y:50,opacity:0,scale:.95},transition:{type:"spring",damping:25,stiffness:300},className:"w-full max-w-sm rounded-3xl bg-white dark:bg-gray-800 shadow-2xl border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-5 border-b border-blue-100 dark:border-blue-800 flex justify-between items-center",children:[e.jsxs("h4",{className:"font-bold text-lg text-blue-700 dark:text-blue-300 flex items-center gap-2",children:[e.jsx(ge,{className:"text-xl"})," Nháº­p Kho Nhanh"]}),e.jsx("button",{onClick:x,className:"p-1 rounded-full hover:bg-blue-100 dark:hover:bg-blue-800/50 text-blue-600 dark:text-blue-400 transition",children:e.jsx(G,{size:20})})]}),e.jsxs("div",{className:"p-6 space-y-5",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 uppercase font-medium tracking-wide mb-1",children:"Sáº£n pháº©m"}),e.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100 text-lg line-clamp-2 leading-tight",children:d.name}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1 font-mono",children:["ID: #",d.id]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900/50 p-4 rounded-2xl border border-gray-100 dark:border-gray-700",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-600 dark:text-gray-300 mb-2 text-center",children:"Sá»‘ lÆ°á»£ng nháº­p thÃªm"}),e.jsx("input",{type:"number",autoFocus:!0,disabled:m,className:"w-full bg-white dark:bg-gray-800 border-2 border-blue-100 dark:border-blue-900/50 focus:border-blue-500 dark:focus:border-blue-500 rounded-xl py-3 text-center text-2xl font-bold text-blue-600 dark:text-blue-400 outline-none transition-colors placeholder-gray-300 disabled:opacity-50",placeholder:"0",value:r,onChange:i=>a(i.target.value),onKeyDown:i=>i.key==="Enter"&&g()})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:x,disabled:m,className:"flex-1 py-3 rounded-xl border border-gray-200 dark:border-gray-600 font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition disabled:opacity-50",children:"Há»§y"}),e.jsx("button",{onClick:g,disabled:m,className:"flex-1 py-3 rounded-xl bg-blue-600 hover:bg-blue-700 text-white font-bold shadow-lg shadow-blue-200 dark:shadow-none active:scale-95 transition-transform disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:m?"Äang lÆ°u...":"XÃ¡c nháº­n"})]})]})]})})})})}function ts({open:t,setOpen:n,selected:d,reload:r,clearSelected:a}){const[l,m]=o.useState(!1),j=async()=>{try{m(!0);const x=localStorage.getItem("token"),g=await fetch(`${lt}/products/${d.id}`,{method:"DELETE",headers:{...x&&{Authorization:`Bearer ${x}`}}}),i=await g.json();if(!g.ok)throw new Error(i.message||"Lá»—i khi xoÃ¡");K.success("ðŸ—‘ï¸ ÄÃ£ áº©n sáº£n pháº©m thÃ nh cÃ´ng"),n(!1),a(),await r()}catch(x){console.error(x),K.error("âŒ KhÃ´ng thá»ƒ xoÃ¡ sáº£n pháº©m")}finally{m(!1)}};return e.jsx(it,{children:e.jsx(A,{children:t&&d&&e.jsx(v.div,{className:"fixed inset-0 z-[99999] flex items-end sm:items-center justify-center bg-black/60 backdrop-blur-sm p-4",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>!l&&n(!1),children:e.jsx(v.div,{onClick:x=>x.stopPropagation(),initial:{y:50,opacity:0,scale:.95},animate:{y:0,opacity:1,scale:1},exit:{y:50,opacity:0,scale:.95},transition:{type:"spring",damping:25,stiffness:300},className:"w-full max-w-sm rounded-3xl bg-white dark:bg-gray-800 shadow-2xl border border-gray-100 dark:border-gray-700 overflow-hidden",children:e.jsxs("div",{className:"p-6 text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/30 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(yt,{className:"text-3xl text-red-600 dark:text-red-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 mb-2",children:"áº¨n sáº£n pháº©m nÃ y?"}),e.jsxs("p",{className:"text-gray-500 dark:text-gray-400 text-sm leading-relaxed px-4",children:["Báº¡n cÃ³ cháº¯c cháº¯n muá»‘n áº©n ",e.jsxs("b",{children:['"',d.name,'"']})," khÃ´ng? HÃ nh Ä‘á»™ng nÃ y sáº½ Ä‘Æ°a sáº£n pháº©m vÃ o kho lÆ°u trá»¯."]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>n(!1),disabled:l,className:"flex-1 py-3 rounded-xl border border-gray-200 dark:border-gray-600 font-medium text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-700 transition disabled:opacity-50",children:"KhÃ´ng, giá»¯ láº¡i"}),e.jsx("button",{onClick:j,disabled:l,className:"flex-1 py-3 rounded-xl bg-red-600 hover:bg-red-700 text-white font-bold shadow-lg shadow-red-200 dark:shadow-none active:scale-95 transition-transform disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:l?"Äang xá»­ lÃ½...":"Äá»“ng Ã½ áº©n"})]})]})})})})})}function Ie({viewType:t="list"}){const n=Array(6).fill(0);return e.jsx("div",{className:`grid gap-3 ${t==="grid"?"grid-cols-2":"grid-cols-1"}`,children:n.map((d,r)=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-xl border border-gray-100 dark:border-gray-700 shadow-sm flex gap-3 animate-pulse",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-200 dark:bg-gray-700 rounded-lg shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2 py-1",children:[e.jsx("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"}),e.jsxs("div",{className:"flex justify-between items-end pt-2",children:[e.jsx("div",{className:"h-5 bg-gray-200 dark:bg-gray-700 rounded w-1/3"}),e.jsx("div",{className:"h-8 w-8 bg-gray-200 dark:bg-gray-700 rounded-full"})]})]})]},r))})}const ss=t=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t);function as(){const t=jt(),[n,d]=o.useState(null),[r,a]=o.useState(""),[l,m]=o.useState(""),[j,x]=o.useState(!1),[g,i]=o.useState(!1),[f,y]=o.useState(null),[k,p]=o.useState(""),[s,c]=o.useState("list"),[u,C]=o.useState("list"),{setIsNavVisible:N}=te(),z=o.useRef(0),w=h=>{const b=h.target.scrollTop;if(b<0)return;const F=b-z.current;Math.abs(F)<10||(F>0&&b>60?N(!1):F<0&&N(!0),z.current=b)};o.useEffect(()=>{N(!0)},[]);const{data:T=[],isLoading:_,isError:$}=vt({queryKey:["products",r],queryFn:async()=>{const h=await P(`/products${r?`?q=${encodeURIComponent(r)}`:""}`);return Array.isArray(h)?h:[]},keepPreviousData:!0}),L=async()=>{await t.invalidateQueries(["products"])};$&&K.error("KhÃ´ng thá»ƒ káº¿t ná»‘i Server!",{id:"err-load"});const I=o.useMemo(()=>T.filter(h=>l?h.brand===l:!0),[T,l]),D=o.useMemo(()=>{const h=T.length,b=T.filter(O=>(O.quantity||0)<=0).length,F=T.reduce((O,E)=>O+Number(E.price||0)*Number(E.quantity||0),0);return{totalItems:h,outOfStock:b,totalValue:F}},[T]),V=(h,b=null)=>{h==="edit"&&b?(d(b),c("edit")):h==="create"?(d(null),c("create")):(c("list"),d(null))};return e.jsxs("div",{className:"h-[100dvh] w-full bg-gray-50 dark:bg-gray-900 font-sans text-gray-900 flex flex-col overflow-hidden transition-colors duration-300 pt-0 md:pt-16",children:[e.jsx("style",{children:`
        .hide-scroll-force::-webkit-scrollbar { display: none !important; width: 0 !important; }
        .hide-scroll-force { -ms-overflow-style: none !important; scrollbar-width: none !important; }
      `}),e.jsxs("div",{className:"hidden md:flex flex-col h-full w-full overflow-hidden",children:[e.jsxs("div",{className:"shrink-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 flex items-center justify-between shadow-sm z-20",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white flex items-center gap-3",children:[e.jsx("span",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 text-blue-600 rounded-xl",children:e.jsx(X,{})}),"Kho HÃ ng"]}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1 pl-12",children:"Quáº£n lÃ½ sáº£n pháº©m vÃ  tá»“n kho"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 bg-blue-50 dark:bg-blue-900/10 border border-blue-100 dark:border-blue-800 rounded-xl",children:[e.jsx("div",{className:"p-2 bg-blue-100 dark:bg-blue-800 rounded-lg text-blue-600 dark:text-blue-300",children:e.jsx(H,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold",children:"Tá»•ng SP"}),e.jsx("p",{className:"text-lg font-bold text-blue-700 dark:text-blue-400",children:D.totalItems})]})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 bg-red-50 dark:bg-red-900/10 border border-red-100 dark:border-red-800 rounded-xl",children:[e.jsx("div",{className:"p-2 bg-red-100 dark:bg-red-800 rounded-lg text-red-600 dark:text-red-300",children:e.jsx(tt,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold",children:"Háº¿t hÃ ng"}),e.jsx("p",{className:"text-lg font-bold text-red-700 dark:text-red-400",children:D.outOfStock})]})]}),e.jsxs("div",{className:"flex items-center gap-3 px-4 py-2 bg-green-50 dark:bg-green-900/10 border border-green-100 dark:border-green-800 rounded-xl",children:[e.jsx("div",{className:"p-2 bg-green-100 dark:bg-green-800 rounded-lg text-green-600 dark:text-green-300",children:e.jsx(ce,{size:18})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold",children:"GiÃ¡ trá»‹ kho"}),e.jsx("p",{className:"text-lg font-bold text-green-700 dark:text-green-400",children:ss(D.totalValue)})]})]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"w-[380px] lg:w-[420px] xl:w-[480px] flex flex-col border-r border-gray-200 dark:border-gray-700 bg-white/50 dark:bg-gray-800/50 backdrop-blur-xl z-10",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 dark:border-gray-700 space-y-3",children:[e.jsxs("div",{className:"relative group",children:[e.jsx(U,{className:"absolute top-3 left-3 text-gray-400 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{className:"w-full pl-10 pr-4 py-2.5 bg-gray-100 dark:bg-gray-900/50 border border-transparent focus:border-blue-500 focus:bg-white dark:focus:bg-gray-900 rounded-xl text-sm outline-none transition-all",placeholder:"TÃ¬m kiáº¿m sáº£n pháº©m...",value:r,onChange:h=>a(h.target.value)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-900/50 p-1 rounded-lg",children:[e.jsx("button",{onClick:()=>C("list"),className:`p-1.5 rounded-md transition-all ${u==="list"?"bg-white dark:bg-gray-700 shadow-sm text-blue-600":"text-gray-400 hover:text-gray-600"}`,children:e.jsx(se,{size:16})}),e.jsx("button",{onClick:()=>C("grid"),className:`p-1.5 rounded-md transition-all ${u==="grid"?"bg-white dark:bg-gray-700 shadow-sm text-blue-600":"text-gray-400 hover:text-gray-600"}`,children:e.jsx(ae,{size:16})})]}),e.jsxs("button",{onClick:()=>V("create"),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-xl text-sm font-bold shadow-lg shadow-blue-500/20 active:scale-95 transition-all",children:[e.jsx(de,{size:16})," ThÃªm má»›i"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-3",children:_?e.jsx(Ie,{viewType:u}):e.jsx(Fe,{filtered:I,selected:n,setSelected:h=>V("edit",h),listLoading:!1,onRestock:h=>{y(h),p(""),x(!0)},viewType:u,gridCols:2})})]}),e.jsx("div",{className:"flex-1 bg-gray-50/50 dark:bg-gray-900/50 relative overflow-hidden flex flex-col",children:e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-6 lg:p-10",children:e.jsx(A,{mode:"wait",children:s==="create"?e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"max-w-4xl mx-auto bg-white dark:bg-gray-800 rounded-2xl shadow-xl border border-gray-100 dark:border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50 dark:bg-gray-700/30",children:[e.jsx("h2",{className:"text-lg font-bold",children:"ThÃªm sáº£n pháº©m má»›i"}),e.jsx("button",{onClick:()=>c("list"),className:"text-sm text-gray-500 hover:text-red-500",children:"Há»§y bá»"})]}),e.jsx("div",{className:"p-6",children:e.jsx(_e,{load:L,onSuccess:()=>c("list")})})]},"create-form"):n?e.jsx(v.div,{initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.98},className:"h-full",children:e.jsx($e,{selected:n,setSelected:d,load:L})},"detail-view"):e.jsxs(v.div,{initial:{opacity:0},animate:{opacity:1},className:"h-full flex flex-col items-center justify-center text-gray-300 dark:text-gray-600 select-none",children:[e.jsx("div",{className:"w-32 h-32 bg-gray-200 dark:bg-gray-800 rounded-full flex items-center justify-center mb-6 animate-pulse",children:e.jsx(X,{size:64,className:"opacity-50"})}),e.jsx("p",{className:"text-xl font-medium",children:"Chá»n má»™t sáº£n pháº©m Ä‘á»ƒ xem chi tiáº¿t"}),e.jsx("p",{className:"text-sm mt-2",children:'Hoáº·c nháº¥n "ThÃªm má»›i" Ä‘á»ƒ táº¡o kho'})]},"empty")})})})]})]}),e.jsxs("div",{className:"md:hidden flex-1 flex flex-col w-full overflow-hidden bg-gray-50 dark:bg-gray-900",children:[s==="list"&&e.jsxs("div",{className:"shrink-0 flex items-center gap-2 p-3 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 z-20 shadow-sm",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(U,{className:"absolute top-2.5 left-3 text-gray-400"}),e.jsx("input",{className:"w-full pl-9 pr-8 py-2 bg-gray-100 dark:bg-gray-700 rounded-xl text-sm outline-none dark:text-white",placeholder:"TÃ¬m sáº£n pháº©m...",value:r,onChange:h=>a(h.target.value)}),r&&e.jsx("button",{onClick:()=>a(""),className:"absolute top-2.5 right-3 text-gray-400",children:"âœ•"})]}),e.jsxs("div",{className:"flex gap-1 shrink-0",children:[e.jsx("button",{onClick:()=>C(h=>h==="grid"?"list":"grid"),className:"p-2 bg-gray-100 dark:bg-gray-700 rounded-lg text-gray-600 dark:text-gray-300",children:u==="grid"?e.jsx(se,{size:20}):e.jsx(ae,{size:20})}),e.jsx("button",{onClick:()=>V("create"),className:"p-2 bg-blue-600 text-white rounded-lg shadow-md active:scale-95 transition-transform",children:e.jsx(de,{size:20})})]})]}),e.jsx("div",{className:"flex-1 overflow-hidden w-full relative",children:e.jsxs(A,{mode:"wait",children:[s==="list"&&e.jsx(v.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"h-full w-full",children:e.jsx("div",{onScroll:w,className:"h-full w-full overflow-y-auto pb-0 px-1 scroll-smooth hide-scroll-force",children:_?e.jsx(Ie,{viewType:u}):e.jsx(Fe,{filtered:I,selected:n,setSelected:h=>V("edit",h),listLoading:!1,onRestock:h=>{y(h),p(""),x(!0)},viewType:u,gridCols:2})})},"list"),s==="create"&&e.jsxs(v.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"absolute inset-0 z-30 bg-white dark:bg-gray-900 flex flex-col",children:[e.jsxs("div",{className:"shrink-0 flex items-center gap-2 p-3 bg-white dark:bg-gray-800 border-b dark:border-gray-700",children:[e.jsx("button",{onClick:()=>V("list"),className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(Q,{size:24})}),e.jsx("h3",{className:"font-bold text-lg",children:"ThÃªm sáº£n pháº©m má»›i"})]}),e.jsx("div",{onScroll:w,className:"flex-1 overflow-y-auto pb-0 hide-scroll-force",children:e.jsx(_e,{load:L,onSuccess:()=>c("list")})})]},"create"),s==="edit"&&e.jsxs(v.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:200},className:"absolute inset-0 z-30 bg-white dark:bg-gray-900 flex flex-col",children:[e.jsxs("div",{className:"shrink-0 flex items-center gap-2 p-3 bg-white dark:bg-gray-800 border-b dark:border-gray-700",children:[e.jsx("button",{onClick:()=>V("list"),className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-700",children:e.jsx(Q,{size:24})}),e.jsx("h3",{className:"font-bold text-lg truncate flex-1",children:n?.name||"Chi tiáº¿t sáº£n pháº©m"})]}),e.jsx("div",{onScroll:w,className:"flex-1 overflow-y-auto pb-0 hide-scroll-force",children:n&&e.jsx($e,{selected:n,setSelected:d,load:L})})]},"edit")]})})]}),e.jsx(es,{open:j,setOpen:x,product:f,qty:k,setQty:p,reload:L}),e.jsx(ts,{open:g,setOpen:i,selected:n,reload:L,clearSelected:()=>d(null)})]})}function rs(t){return Number(t||0).toLocaleString("vi-VN")+"Ä‘"}function ns({stats:t}){return e.jsxs("div",{className:"grid sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 border rounded p-3 text-center",children:[e.jsx("div",{className:"text-gray-500 text-sm",children:"ðŸ‘¥ Tá»•ng khÃ¡ch hÃ ng"}),e.jsx("div",{className:"text-2xl font-semibold text-blue-700",children:t.total_customers})]}),e.jsxs("div",{className:"bg-green-50 border rounded p-3 text-center",children:[e.jsx("div",{className:"text-gray-500 text-sm",children:"ðŸ“¦ Tá»•ng sá»‘ Ä‘Æ¡n"}),e.jsx("div",{className:"text-2xl font-semibold text-green-700",children:t.total_orders})]}),e.jsxs("div",{className:"bg-yellow-50 border rounded p-3 text-center",children:[e.jsx("div",{className:"text-gray-500 text-sm",children:"ðŸ’° Tá»•ng doanh thu"}),e.jsx("div",{className:"text-2xl font-semibold text-yellow-700",children:rs(t.total_revenue)})]})]})}function De({form:t,setForm:n,submit:d}){return e.jsxs("div",{className:"bg-white p-4 rounded-2xl border shadow-sm",children:[e.jsx("h3",{className:"font-semibold mb-3 text-lg flex items-center gap-2",children:"ðŸ§â€â™€ï¸ ThÃªm khÃ¡ch hÃ ng"}),e.jsxs("form",{onSubmit:d,className:"grid gap-2",children:[e.jsx("input",{className:"input",placeholder:"TÃªn *",value:t.name,onChange:r=>n({...t,name:r.target.value}),required:!0}),e.jsx("input",{className:"input",placeholder:"Sá»‘ Ä‘iá»‡n thoáº¡i",value:t.phone,onChange:r=>n({...t,phone:r.target.value})}),e.jsx("input",{className:"input",placeholder:"Facebook URL",value:t.facebook_url,onChange:r=>n({...t,facebook_url:r.target.value})}),e.jsx("input",{className:"input",placeholder:"Äá»‹a chá»‰",value:t.address,onChange:r=>n({...t,address:r.target.value})}),e.jsx("textarea",{className:"input",placeholder:"Ghi chÃº",value:t.notes,onChange:r=>n({...t,notes:r.target.value})}),e.jsx("button",{className:"btn bg-blue-600 hover:bg-blue-700 text-white",children:"âž• ThÃªm khÃ¡ch hÃ ng"})]})]})}function ls({customer:t,onCancel:n,onSaved:d}){const[r,a]=o.useState({name:t.name,phone:t.phone||"",address:t.address||"",facebook_url:t.facebook_url||"",notes:t.notes||""}),[l,m]=o.useState(!1),j=async()=>{m(!0);try{await P(`/customers/${t.id}`,{method:"PUT",body:JSON.stringify(r)}),S.success("ðŸ’¾ ÄÃ£ lÆ°u thÃ´ng tin khÃ¡ch hÃ ng"),d()}catch{S.error("âŒ Lá»—i khi lÆ°u khÃ¡ch hÃ ng")}finally{m(!1)}};return e.jsxs("div",{className:"grid gap-2 text-sm",children:[e.jsx("input",{className:"input",placeholder:"TÃªn",value:r.name,onChange:x=>a({...r,name:x.target.value})}),e.jsx("input",{className:"input",placeholder:"Äiá»‡n thoáº¡i",value:r.phone,onChange:x=>a({...r,phone:x.target.value})}),e.jsx("input",{className:"input",placeholder:"Äá»‹a chá»‰",value:r.address,onChange:x=>a({...r,address:x.target.value})}),e.jsx("input",{className:"input",placeholder:"Facebook URL",value:r.facebook_url,onChange:x=>a({...r,facebook_url:x.target.value})}),e.jsx("textarea",{className:"input",placeholder:"Ghi chÃº",value:r.notes,onChange:x=>a({...r,notes:x.target.value})}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsxs("button",{className:"btn bg-green-500 hover:bg-green-600 text-white",onClick:j,disabled:l,children:["ðŸ’¾ ",l?"Äang lÆ°u...":"LÆ°u"]}),e.jsx("button",{className:"btn bg-gray-300",onClick:n,children:"âŒ Huá»·"})]})]})}function be(t){return Number(t||0).toLocaleString("vi-VN")+"Ä‘"}function Pe({detail:t,setEditing:n,editing:d,viewDetail:r,setDetail:a,setSelected:l,loadList:m}){const j=async()=>{if(await S.confirm(`Báº¡n cháº¯c cháº¯n muá»‘n xoÃ¡ khÃ¡ch "${t.name}"?`))try{await P(`/customers/${t.id}`,{method:"DELETE"}),S.success("ðŸ—‘ï¸ ÄÃ£ xoÃ¡ khÃ¡ch hÃ ng"),a(null),l(null),m()}catch{S.error("âŒ Lá»—i khi xoÃ¡ khÃ¡ch hÃ ng")}};return e.jsxs("div",{className:"pb-[70px] sm:pb-4",children:[" ",e.jsxs("div",{className:`p-4 rounded-2xl bg-white shadow-sm border border-gray-200 
                    dark:bg-gray-900 dark:border-gray-700`,children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-semibold text-xl text-gray-800 dark:text-white flex items-center gap-2",children:["ðŸ§¾ ",t.name]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:`px-3 py-1.5 rounded-xl text-xs font-medium bg-yellow-300 hover:bg-yellow-400 
                       transition shadow-sm`,onClick:()=>n(!0),children:"âœï¸ Sá»­a"}),e.jsx("button",{className:`px-3 py-1.5 rounded-xl text-xs font-medium bg-red-500 hover:bg-red-600 
                       text-white transition shadow-sm`,onClick:j,children:"ðŸ—‘ï¸ XoÃ¡"})]})]}),d?e.jsx(ls,{customer:t,onCancel:()=>n(!1),onSaved:async()=>{await r(t),n(!1),m()}}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-6 gap-y-3 text-sm mb-4",children:[e.jsx(ee,{label:"ðŸ“ž Äiá»‡n thoáº¡i",value:t.phone}),e.jsx(ee,{label:"ðŸ“ Äá»‹a chá»‰",value:t.address}),e.jsx(ee,{label:"ðŸŒ Facebook",value:t.facebook_url?e.jsx("a",{href:t.facebook_url,target:"_blank",className:"text-blue-600 underline",children:"Link"}):"â€”"}),e.jsx(ee,{label:"ðŸ“ Ghi chÃº",value:t.notes}),e.jsx(ee,{label:"ðŸ§® Tá»•ng Ä‘Æ¡n",value:`${t.total_orders} Ä‘Æ¡n`}),e.jsx(ee,{label:"ðŸ’° Chi tiÃªu",value:e.jsx("span",{className:"font-semibold text-green-600",children:be(t.total_spent)})})]}),e.jsx("h5",{className:"font-semibold mb-3 text-lg text-gray-800 dark:text-white",children:"ðŸ›ï¸ Lá»‹ch sá»­ mua hÃ ng"}),t.orders?.length===0?e.jsx("div",{className:"text-gray-500 text-sm",children:"KhÃ¡ch chÆ°a cÃ³ Ä‘Æ¡n hÃ ng nÃ o."}):e.jsx("div",{className:"space-y-3",children:t.orders.map(x=>e.jsxs("div",{className:`rounded-xl border border-gray-200 bg-gray-50 p-3 shadow-sm 
                         dark:bg-gray-800 dark:border-gray-700`,children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("div",{className:"font-medium",children:["MÃ£ Ä‘Æ¡n: #",x.id]}),e.jsx("div",{className:"text-gray-500 dark:text-gray-300",children:new Date(x.created_at).toLocaleString("vi-VN")})]}),e.jsxs("div",{className:"mt-1 text-gray-700 dark:text-gray-300",children:["Tá»•ng tiá»n: ",e.jsx("b",{children:be(x.total)})]}),e.jsx("div",{className:"mt-3 flex flex-wrap gap-3",children:x.items.map((g,i)=>e.jsxs("div",{className:"flex items-center gap-2",children:[g.cover_image&&e.jsx("img",{src:g.cover_image,alt:g.product_name,className:"w-12 h-12 rounded-lg border object-cover shadow-sm"}),e.jsxs("span",{className:"text-gray-800 dark:text-gray-200 text-sm",children:[g.product_name," Ã— ",g.quantity," (",be(g.price),")"]})]},i))})]},x.id))})]})]})}function ee({label:t,value:n}){return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"text-gray-500 dark:text-gray-400",children:t}),e.jsx("div",{className:"font-medium text-gray-700 dark:text-gray-200",children:n||"â€”"})]})}const Ee=[["#FF9A9E","#FECFEF"],["#A18CD1","#FBC2EB"],["#84FAB0","#8FD3F4"],["#89F7FE","#66A6FF"],["#F6D365","#FDA085"],["#5EE7DF","#B490CA"],["#FF8177","#FF867A"],["#92FE9D","#00C9FF"]];function Ve(t=""){const n=(t.charCodeAt(0)||0)%Ee.length,[d,r]=Ee[n];return`linear-gradient(135deg, ${d}, ${r})`}function Me(t=""){const n=t.trim().split(" ");return n.length>=2?(n[0][0]+n[1][0]).toUpperCase():(t.trim()[0]||"?").toUpperCase()}function Oe(t){return Number(t||0).toLocaleString("vi-VN")+"Ä‘"}function is(){const[t,n]=o.useState([]),[d,r]=o.useState(null),[a,l]=o.useState(null),[m,j]=o.useState(!1),[x,g]=o.useState(!1),[i,f]=o.useState(""),[y,k]=o.useState(!1),[p,s]=o.useState(!1),[c,u]=o.useState({total_customers:0,total_orders:0,total_revenue:0}),[C,N]=o.useState({name:"",phone:"",address:"",facebook_url:"",notes:""}),[z,w]=o.useState("list"),[T,_]=o.useState("grid"),{setIsNavVisible:$}=te();o.useRef(0),o.useEffect(()=>{$(!0),L()},[]);const L=async()=>{try{const[h,b]=await Promise.all([P("/customers"),P("/orders")]),F=b.reduce((E,M)=>E+Number(M.total||0),0);u({total_customers:h.length,total_orders:b.length,total_revenue:F});const O=h.map(E=>{const M=b.filter(R=>R.customer_id&&String(R.customer_id)===String(E.id)||R.phone&&R.phone===E.phone),Y=M.length,B=M.reduce((R,ot)=>R+Number(ot.total||0),0);return{...E,total_orders:Y,total_spent:B}});n(O)}catch(h){console.error(h),S.error("KhÃ´ng thá»ƒ táº£i dá»¯ liá»‡u")}},I=o.useMemo(()=>t.filter(h=>{if(y&&(h.total_orders||0)<3)return!1;const b=i.trim().toLowerCase();if(!b)return!0;const F=(h.phone||"").replace(/\D/g,""),O=b.replace(/\D/g,"");return(h.name||"").toLowerCase().includes(b)||(h.phone||"").toLowerCase().includes(b)||O&&F.includes(O)}),[t,i,y]),D=async h=>{h.preventDefault();try{await P("/customers",{method:"POST",body:JSON.stringify(C)}),S.success("ThÃªm khÃ¡ch hÃ ng thÃ nh cÃ´ng"),N({name:"",phone:"",address:"",facebook_url:"",notes:""}),await L(),s(!1),w("list")}catch{S.error("Lá»—i thÃªm khÃ¡ch hÃ ng")}},V=async h=>{if(d?.id!==h.id){r(h),j(!0),window.innerWidth<768&&w("detail");try{const b=await P(`/customers/${h.id}`);l(b)}catch{S.error("Lá»—i táº£i chi tiáº¿t")}j(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        .hide-scroll-force::-webkit-scrollbar { display: none !important; width: 0 !important; }
        .hide-scroll-force { -ms-overflow-style: none !important; scrollbar-width: none !important; }
        /* Animation cho modal */
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }
      `}),e.jsxs("div",{className:"h-[100dvh] w-full bg-gray-50 dark:bg-gray-900 flex flex-col overflow-hidden pt-0 md:pt-16",children:[e.jsxs("div",{className:"md:hidden shrink-0 bg-white/80 dark:bg-gray-900/80 backdrop-blur-md border-b border-gray-200 dark:border-gray-700 z-20",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 gap-2",children:[e.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-800 p-1 rounded-xl flex-1",children:[e.jsx("button",{onClick:()=>w("list"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${z==="list"?"bg-white dark:bg-gray-700 shadow text-blue-600":"text-gray-500"}`,children:"Danh sÃ¡ch"}),e.jsx("button",{onClick:()=>w("stats"),className:`flex-1 py-2 rounded-lg text-xs font-bold transition-all ${z==="stats"?"bg-white dark:bg-gray-700 shadow text-blue-600":"text-gray-500"}`,children:"Thá»‘ng kÃª"})]}),e.jsx("button",{onClick:()=>w("create"),className:"w-10 h-10 flex items-center justify-center bg-blue-600 text-white rounded-full shadow-lg hover:bg-blue-700 active:scale-95 transition-transform",children:e.jsx(we,{size:20})})]}),z==="list"&&e.jsxs("div",{className:"px-3 pb-3 flex items-center gap-2",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(U,{className:"absolute top-2.5 left-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"TÃ¬m tÃªn, SÄT...",value:i,onChange:h=>f(h.target.value),className:"w-full bg-gray-100 dark:bg-gray-800 pl-9 pr-3 py-2 rounded-xl text-sm outline-none focus:ring-2 focus:ring-blue-500/20 transition-all"})]}),e.jsxs("button",{onClick:()=>k(!y),className:`h-9 px-3 rounded-xl flex items-center gap-1 text-xs font-bold border transition-all ${y?"bg-yellow-50 border-yellow-200 text-yellow-700":"bg-white border-gray-200 text-gray-500 dark:bg-gray-800 dark:border-gray-700"}`,children:[e.jsx(me,{className:y?"fill-yellow-500 text-yellow-500":""})," ","VIP"]})]})]}),e.jsxs("div",{className:"hidden md:flex flex-col h-full",children:[e.jsxs("div",{className:"shrink-0 px-6 py-4 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 dark:text-white",children:"KhÃ¡ch hÃ ng"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Quáº£n lÃ½ danh sÃ¡ch vÃ  lá»‹ch sá»­ mua hÃ ng"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("div",{className:"relative group",children:[e.jsx(U,{className:"absolute top-3 left-3 text-gray-400 group-focus-within:text-blue-500 transition-colors"}),e.jsx("input",{type:"text",placeholder:"TÃ¬m kiáº¿m...",value:i,onChange:h=>f(h.target.value),className:"w-64 bg-gray-100 dark:bg-gray-900 pl-10 pr-4 py-2.5 rounded-xl text-sm outline-none focus:ring-2 focus:ring-blue-500/30 border border-transparent focus:border-blue-500 transition-all"})]}),e.jsxs("button",{onClick:()=>k(!y),className:`flex items-center gap-2 px-4 py-2.5 rounded-xl text-sm font-bold border transition-all hover:shadow-sm ${y?"bg-yellow-50 border-yellow-200 text-yellow-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:[e.jsx(me,{className:y?"fill-yellow-500":""}),"VIP"]}),e.jsxs("button",{onClick:()=>s(!0),className:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-xl text-sm font-bold shadow-lg shadow-blue-500/30 transition-all active:scale-95",children:[e.jsx(we,{size:18})," ThÃªm khÃ¡ch"]})]})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:`flex-1 overflow-y-auto hide-scroll-force p-6 transition-all ${d?"w-2/3 border-r border-gray-200 dark:border-gray-700":"w-full"}`,children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-2xl border border-gray-100 dark:border-gray-700 shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Tá»•ng khÃ¡ch"}),e.jsx("div",{className:"text-2xl font-bold text-gray-800 dark:text-white mt-1",children:c.total_customers})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-2xl border border-gray-100 dark:border-gray-700 shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"ÄÆ¡n hÃ ng"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 mt-1",children:c.total_orders})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-2xl border border-gray-100 dark:border-gray-700 shadow-sm",children:[e.jsx("div",{className:"text-xs text-gray-500 uppercase font-bold",children:"Doanh thu"}),e.jsx("div",{className:"text-2xl font-bold text-green-600 mt-1",children:Oe(c.total_revenue)})]})]}),e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-2xl border border-gray-200 dark:border-gray-700 shadow-sm overflow-hidden",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700/50 text-gray-500 dark:text-gray-400 text-xs uppercase font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4",children:"KhÃ¡ch hÃ ng"}),e.jsx("th",{className:"px-6 py-4",children:"LiÃªn há»‡"}),e.jsx("th",{className:"px-6 py-4 text-center",children:"ÄÆ¡n hÃ ng"}),e.jsx("th",{className:"px-6 py-4 text-right",children:"Chi tiÃªu"}),e.jsx("th",{className:"px-6 py-4"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:[I.map(h=>e.jsxs("tr",{onClick:()=>V(h),className:`cursor-pointer transition-colors hover:bg-blue-50/50 dark:hover:bg-blue-900/10 ${d?.id===h.id?"bg-blue-50 dark:bg-blue-900/20":""}`,children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full flex items-center justify-center text-white text-sm font-bold shadow-sm",style:{background:Ve(h.name)},children:Me(h.name)}),e.jsxs("div",{children:[e.jsxs("div",{className:"font-bold text-gray-800 dark:text-white text-sm flex items-center gap-1",children:[h.name,h.total_orders>3&&e.jsx(me,{className:"text-yellow-400 fill-yellow-400 text-[10px]"})]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["ID: #",h.id]})]})]})}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:h.phone}),h.address&&e.jsx("div",{className:"text-xs text-gray-400 truncate max-w-[150px]",children:h.address})]}),e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${h.total_orders>0?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:h.total_orders||0})}),e.jsx("td",{className:"px-6 py-4 text-right font-bold text-gray-700 dark:text-gray-300",children:Oe(h.total_spent||0)}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsx(Q,{className:`text-gray-400 transition-transform ${d?.id===h.id?"rotate-180 text-blue-500":""}`})})]},h.id)),I.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:"5",className:"px-6 py-12 text-center text-gray-400",children:[e.jsx(U,{size:40,className:"mx-auto mb-3 opacity-30"}),"KhÃ´ng tÃ¬m tháº¥y khÃ¡ch hÃ ng nÃ o"]})})]})]})})]}),e.jsx(A,{children:d&&e.jsxs(v.div,{initial:{x:"100%",opacity:0},animate:{x:0,opacity:1},exit:{x:"100%",opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"w-[400px] xl:w-[450px] bg-white dark:bg-gray-800 border-l border-gray-200 dark:border-gray-700 shadow-2xl z-10 flex flex-col h-full",children:[e.jsxs("div",{className:"shrink-0 p-4 border-b border-gray-100 dark:border-gray-700 flex justify-between items-center bg-gray-50/50 dark:bg-gray-800",children:[e.jsx("h3",{className:"font-bold text-gray-700 dark:text-gray-200",children:"Chi tiáº¿t khÃ¡ch hÃ ng"}),e.jsx("button",{onClick:()=>r(null),className:"p-2 hover:bg-gray-200 rounded-full transition",children:e.jsx(G,{})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto hide-scroll-force p-4",children:m?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-2 border-blue-500 rounded-full border-t-transparent"})}):a?e.jsx(Pe,{detail:a,editing:x,setEditing:g,viewDetail:V,setDetail:l,setSelected:r,loadList:L}):e.jsx("div",{className:"text-center py-10 text-gray-400",children:"Vui lÃ²ng chá»n khÃ¡ch hÃ ng"})})]})})]})]}),e.jsxs("div",{className:"md:hidden flex-1 overflow-y-auto hide-scroll-force p-3 pb-24",children:[z==="create"&&e.jsx(De,{form:C,setForm:N,submit:D}),z==="stats"&&e.jsx(ns,{stats:c}),z==="list"&&e.jsx("div",{className:T==="grid"?"grid grid-cols-2 gap-3":"flex flex-col gap-3",children:I.map(h=>e.jsxs("div",{onClick:()=>V(h),className:`relative overflow-hidden bg-white dark:bg-gray-900 border border-gray-100 dark:border-gray-800 cursor-pointer shadow-sm active:scale-95 transition-all ${T==="grid"?"p-3 rounded-2xl flex flex-col items-center text-center gap-2":"p-3 rounded-xl flex items-center gap-3"}`,children:[h.total_orders>3&&e.jsx("span",{className:"absolute top-0 right-0 bg-yellow-400 text-white text-[8px] font-bold px-1.5 py-0.5 rounded-bl-lg shadow-sm z-10",children:"VIP"}),e.jsx("div",{className:"shrink-0 w-12 h-12 rounded-full flex items-center justify-center font-bold text-white text-lg shadow-inner",style:{background:Ve(h.name)},children:Me(h.name)}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-800 dark:text-gray-100 text-sm truncate",children:h.name}),e.jsx("p",{className:"text-xs text-gray-500 truncate mt-0.5",children:h.phone||"ChÆ°a cÃ³ SÄT"}),T!=="grid"&&h.address&&e.jsx("p",{className:"text-[10px] text-gray-400 truncate mt-0.5",children:h.address})]}),T!=="grid"&&e.jsx("a",{href:`tel:${h.phone}`,onClick:b=>b.stopPropagation(),className:"w-8 h-8 flex items-center justify-center rounded-full bg-blue-50 text-blue-600",children:e.jsx(ke,{size:14})}),T==="grid"&&e.jsxs("div",{className:"w-full pt-2 border-t border-gray-50 dark:border-gray-800 flex gap-2 mt-auto",children:[e.jsx("a",{href:`tel:${h.phone}`,onClick:b=>b.stopPropagation(),className:"flex-1 py-1.5 bg-blue-50 dark:bg-blue-900/20 text-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(ke,{size:14})}),h.facebook_url&&e.jsx("a",{href:h.facebook_url,target:"_blank",onClick:b=>b.stopPropagation(),className:"flex-1 py-1.5 bg-indigo-50 dark:bg-indigo-900/20 text-indigo-600 rounded-lg flex items-center justify-center",children:e.jsx(Nt,{size:14})})]})]},h.id))})]}),p&&e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4 animate-[fadeIn_0.2s_ease-out]",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 w-full max-w-md rounded-3xl shadow-2xl p-6 relative",children:[e.jsx("button",{onClick:()=>s(!1),className:"absolute top-4 right-4 p-2 text-gray-400 hover:text-gray-600",children:e.jsx(G,{size:24})}),e.jsx("h2",{className:"text-xl font-bold mb-4",children:"ThÃªm khÃ¡ch hÃ ng má»›i"}),e.jsx(De,{form:C,setForm:N,submit:D,onCancel:()=>s(!1)})]})}),z==="detail"&&a&&e.jsxs("div",{className:"fixed inset-0 z-50 bg-gray-50 dark:bg-gray-900 flex flex-col animate-slideIn",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 px-4 py-3 flex items-center gap-3 border-b dark:border-gray-700 shadow-sm shrink-0",children:[e.jsx("button",{onClick:()=>w("list"),className:"w-10 h-10 flex items-center justify-center rounded-full bg-gray-100 dark:bg-gray-700 hover:bg-gray-200",children:e.jsx(Q,{size:24})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-lg truncate",children:a.name}),e.jsx("p",{className:"text-xs text-gray-500",children:"ThÃ´ng tin chi tiáº¿t"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto hide-scroll-force",children:e.jsx(Pe,{detail:a,editing:x,setEditing:g,viewDetail:V,setDetail:l,setSelected:r,loadList:L})})]})]})]})}function Ae(t){return Number(t||0).toLocaleString("vi-VN")+"Ä‘"}function Ke({filtered:t,loading:n,selected:d,setSelected:r}){return n?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400 gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"text-sm",children:"Äang táº£i danh sÃ¡ch..."})]}):!t||t.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-400 gap-2 border border-dashed border-gray-300 rounded-xl m-2",children:[e.jsx(H,{size:32}),e.jsx("span",{className:"text-sm",children:"KhÃ´ng tÃ¬m tháº¥y Ä‘Æ¡n hÃ ng nÃ o."})]}):e.jsx("div",{className:"w-full p-0 space-y-0 md:p-2 md:space-y-3",children:e.jsx(A,{children:t.map(a=>{const l=a.items&&a.items[0],m=l?.cover_image||l?.product_image,j=Number(a.deposit||0),x={pending:"bg-yellow-50 text-yellow-700 border-yellow-200",confirmed:"bg-blue-50 text-blue-700 border-blue-200",shipping:"bg-purple-50 text-purple-700 border-purple-200",completed:"bg-green-50 text-green-700 border-green-200",cancelled:"bg-red-50 text-red-700 border-red-200"},g={pending:"Chá» xá»­ lÃ½",confirmed:"ÄÃ£ xÃ¡c nháº­n",shipping:"Äang giao",completed:"HoÃ n táº¥t",cancelled:"ÄÃ£ há»§y"};return e.jsx(v.div,{layout:!0,initial:{opacity:0},animate:{opacity:1},onClick:()=>r(a),className:`
                group relative cursor-pointer transition-all duration-200

                /* === MOBILE: Pháº³ng, Full width === */
                w-full p-3 bg-white dark:bg-gray-800 rounded-none border-b border-gray-100 dark:border-gray-700 shadow-none

                /* === PC: Card ná»•i === */
                md:rounded-2xl md:border md:border-gray-100 md:dark:border-gray-700 md:p-4 md:shadow-sm md:hover:shadow-lg md:hover:border-blue-300

                ${d?.id===a.id?"bg-blue-50 dark:bg-blue-900/10 md:ring-2 md:ring-blue-500":"hover:bg-gray-50 dark:hover:bg-gray-700/50"}
              `,children:e.jsxs("div",{className:"flex gap-3 md:gap-4",children:[e.jsxs("div",{className:"w-16 h-16 md:w-20 md:h-20 flex-shrink-0 rounded-lg md:rounded-xl overflow-hidden border border-gray-100 bg-gray-50 shadow-inner relative",children:[m?e.jsx("img",{src:m,alt:"sp",className:"w-full h-full object-cover",onError:i=>i.target.src="https://placehold.co/100x100?text=No+Img"}):e.jsx("div",{className:"w-full h-full flex flex-col items-center justify-center text-gray-300 text-[10px] bg-gray-100",children:e.jsx(H,{size:20})}),a.items?.length>1&&e.jsxs("div",{className:"absolute bottom-0 right-0 bg-black/60 text-white text-[10px] px-1.5 py-0.5 rounded-tl-lg font-bold backdrop-blur-sm",children:["+",a.items.length-1]})]}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-between py-0.5",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xs font-bold text-gray-500 bg-gray-100 px-1.5 py-0.5 rounded",children:["#",a.id]}),e.jsx("h4",{className:"font-bold text-gray-800 dark:text-gray-100 text-sm line-clamp-1",children:a.customer_name})]}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1 line-clamp-1",children:l?l.product_name:"ÄÆ¡n hÃ ng trá»‘ng"})]}),e.jsxs("div",{className:"text-right shrink-0",children:[e.jsx("div",{className:"font-bold text-blue-600 text-sm",children:Ae(a.total)}),j>0?e.jsxs("div",{className:"text-[10px] font-medium text-green-600 bg-green-50 px-1.5 py-0.5 rounded-md mt-1 inline-block border border-green-100",children:["Cá»c: ",Ae(j)]}):e.jsx("div",{className:"text-[10px] text-red-400 mt-1 italic",children:"ChÆ°a cá»c"})]})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2 pt-2 border-t border-gray-50 dark:border-gray-700/50",children:[e.jsx("div",{className:"flex items-center gap-2",children:a.china_tracking_code?e.jsxs("div",{className:"flex items-center gap-1 text-gray-600 dark:text-gray-300 text-[11px] bg-gray-50 dark:bg-gray-700 px-2 py-0.5 rounded border border-gray-200 dark:border-gray-600",children:[e.jsx(ge,{size:10}),e.jsxs("span",{className:"font-mono font-medium",children:["...",a.china_tracking_code.slice(-4)]})]}):e.jsx("span",{className:"text-[10px] text-gray-400",children:"---"})}),e.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold uppercase tracking-wide border ${x[a.status]||"bg-gray-100 text-gray-600"}`,children:g[a.status]||a.status})]})]})]})},a.id)})})})}function os({status:t}){switch(t){case"pending":return e.jsx(v.div,{initial:{rotate:0},animate:{rotate:360},transition:{repeat:1/0,duration:2,ease:"linear"},children:e.jsx(st,{className:"inline text-yellow-500 mr-1"})});case"confirmed":return e.jsx(v.div,{animate:{scale:[1,1.2,1]},transition:{repeat:1/0,duration:1.2},children:e.jsx(X,{className:"inline text-purple-500 mr-1"})});case"shipping":return e.jsx(v.div,{className:"inline-flex items-center",initial:{x:-40},animate:{x:[0,60,0]},transition:{repeat:1/0,duration:3,ease:"easeInOut"},children:e.jsxs("span",{className:"relative",children:["ðŸ›µ",e.jsx(v.span,{className:"absolute -top-1 left-3 text-blue-400",animate:{opacity:[0,1,0],x:[0,8,0]},transition:{repeat:1/0,duration:.8},children:"ðŸ’¨"})]})});case"completed":return e.jsx(v.div,{initial:{scale:0},animate:{scale:[1.2,1]},transition:{repeat:1/0,duration:1.5,ease:"easeInOut"},children:e.jsx(je,{className:"inline text-green-500 mr-1"})});case"cancelled":return e.jsx(v.div,{animate:{rotate:[0,15,-15,0]},transition:{repeat:1/0,duration:1},children:e.jsx(wt,{className:"inline text-red-500 mr-1"})});default:return null}}function le(t){return Number(t||0).toLocaleString("vi-VN")+"Ä‘"}function fe({selected:t,updateStatus:n,updating:d,onUpdateTracking:r}){const{id:a}=kt(),[l,m]=o.useState(null),[j,x]=o.useState(""),[g,i]=o.useState(!1),[f,y]=o.useState(!1);o.useEffect(()=>{if(t){m(t),x(t.china_tracking_code||""),y(!1);return}a&&(async()=>{y(!0);try{const T=await P(`/orders/${a}`);m(T),x(T.china_tracking_code||"")}catch(T){console.error(T),S.error("âŒ KhÃ´ng tÃ¬m tháº¥y thÃ´ng tin chi tiáº¿t Ä‘Æ¡n hÃ ng")}finally{y(!1)}})()},[a,t]);const k=async w=>{if(n){n(w);return}if(l)try{await P(`/orders/${l.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:w})}),S.success("Cáº­p nháº­t tráº¡ng thÃ¡i thÃ nh cÃ´ng"),m({...l,status:w})}catch{S.error("Lá»—i cáº­p nháº­t tráº¡ng thÃ¡i")}},p=async()=>{if(l&&j!==(l.china_tracking_code||""))try{i(!0),await P(`/orders/${l.id}/tracking`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({china_tracking_code:j})}),S.success("âœ… ÄÃ£ lÆ°u mÃ£ váº­n Ä‘Æ¡n!"),m({...l,china_tracking_code:j}),r&&r(l.id,j)}catch(w){console.error(w),S.error("âŒ Lá»—i khi lÆ°u mÃ£ váº­n Ä‘Æ¡n")}finally{i(!1)}},s=(w,T)=>{if(!w){S.error(`KhÃ´ng cÃ³ ${T} Ä‘á»ƒ copy`);return}navigator.clipboard.writeText(w),S.success(`ÄÃ£ copy ${T}!`)},c=()=>{if(!l)return;const w=`${l.customer_name} - ${l.customer_phone} - ${l.customer_address||"ChÆ°a cÃ³ Ä‘á»‹a chá»‰"}`;s(w,"thÃ´ng tin giao hÃ ng")},u=w=>{w.target.src!=="/no-image.png"&&(w.target.src="/no-image.png")};if(f)return e.jsxs("div",{className:"p-10 text-center text-gray-500",children:[e.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-blue-500 border-t-transparent rounded-full mx-auto mb-2"}),"â³ Äang táº£i dá»¯ liá»‡u..."]});if(!l)return e.jsx("div",{className:"text-gray-500 text-center py-10",children:"âŒ KhÃ´ng tÃ¬m tháº¥y Ä‘Æ¡n hÃ ng"});const C=Number(l.deposit)||0,N=Number(l.total)||0,z=N-C;return e.jsxs(v.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"p-4 min-h-full bg-gray-50 dark:bg-gray-900",children:[e.jsxs("div",{className:"flex justify-between items-start bg-white dark:bg-gray-800 p-4 rounded-2xl shadow-sm border border-gray-100 mb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 dark:text-white flex items-center gap-2",children:["ÄÆ¡n hÃ ng #",l.id]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mt-1",children:[e.jsx(St,{})," ",new Date(l.created_at).toLocaleString("vi-VN")]})]}),e.jsx(os,{status:l.status})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-start pb-4",children:[e.jsx("div",{className:"md:col-span-1 space-y-4 md:sticky md:top-4",children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-2xl shadow-sm border border-gray-100 relative overflow-hidden",children:[e.jsxs("h3",{className:"font-bold text-gray-700 dark:text-gray-200 flex items-center gap-2 border-b pb-3 mb-3",children:[e.jsx(he,{className:"text-blue-500"})," KhÃ¡ch hÃ ng"]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center text-blue-600 font-bold text-lg",children:l.customer_name?.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-gray-800 text-lg",children:l.customer_name}),e.jsx("div",{className:"text-xs text-gray-500",children:"KhÃ¡ch hÃ ng"})]})]}),e.jsxs("div",{className:"bg-gray-50 p-2 rounded-lg flex justify-between items-center group",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ct,{className:"text-gray-400"}),e.jsx("a",{href:`tel:${l.customer_phone}`,className:"font-mono font-bold text-blue-600 text-base hover:underline",children:l.customer_phone||"â€”"})]}),e.jsx("button",{onClick:()=>s(l.customer_phone,"Sá»‘ Ä‘iá»‡n thoáº¡i"),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-100 rounded",children:e.jsx(ue,{})})]}),e.jsxs("div",{className:"bg-gray-50 p-2 rounded-lg flex justify-between items-start group",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(at,{className:"text-gray-400 mt-1 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-700 leading-relaxed",children:l.customer_address||"ChÆ°a cáº­p nháº­t Ä‘á»‹a chá»‰"})]}),e.jsx("button",{onClick:()=>s(l.customer_address,"Äá»‹a chá»‰"),className:"p-1.5 text-gray-400 hover:text-blue-600 hover:bg-blue-100 rounded flex-shrink-0 ml-1",children:e.jsx(ue,{})})]}),e.jsxs("button",{onClick:c,className:"w-full mt-2 bg-blue-600 hover:bg-blue-700 text-white font-bold py-2.5 rounded-xl shadow-lg shadow-blue-500/30 flex items-center justify-center gap-2 transition-all active:scale-95",children:[e.jsx(ue,{className:"text-lg"})," COPY THÃ”NG TIN SHIP"]})]})]})}),e.jsxs("div",{className:"md:col-span-2 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-4 rounded-2xl border border-blue-100 dark:border-blue-800",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ge,{className:"text-blue-600"}),e.jsx("span",{className:"font-bold text-blue-800 text-sm uppercase",children:"MÃ£ Váº­n ÄÆ¡n (TQ)"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",placeholder:"Nháº­p mÃ£...",value:j,onChange:w=>x(w.target.value),className:"flex-1 px-3 py-2 text-sm border border-blue-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 font-mono uppercase bg-white"}),e.jsx("button",{onClick:p,disabled:g,className:"bg-blue-600 text-white px-3 py-2 rounded-lg hover:bg-blue-700 text-sm",children:g?"...":e.jsx(xe,{})})]})]}),e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-800 p-4 rounded-2xl border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(re,{className:"text-gray-500"}),e.jsx("span",{className:"font-bold text-gray-700 text-sm",children:"Tráº¡ng thÃ¡i Ä‘Æ¡n"})]}),e.jsxs("select",{value:l.status,disabled:d,onChange:w=>k(w.target.value),className:"w-full px-3 py-2 rounded-lg border text-sm bg-white focus:ring-2 focus:ring-blue-500 outline-none",children:[e.jsx("option",{value:"pending",children:"Chá» xá»­ lÃ½"}),e.jsx("option",{value:"confirmed",children:"ÄÃ£ xÃ¡c nháº­n"}),e.jsx("option",{value:"shipping",children:"Äang giao"}),e.jsx("option",{value:"completed",children:"HoÃ n táº¥t"}),e.jsx("option",{value:"cancelled",children:"ÄÃ£ huá»·"})]})]})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 flex items-center gap-2 bg-gray-50/50",children:[e.jsx(X,{className:"text-gray-500"})," ",e.jsx("span",{className:"font-bold text-gray-700",children:"Chi tiáº¿t sáº£n pháº©m"})]}),e.jsx("div",{className:"p-2 space-y-2",children:l.items?.map((w,T)=>e.jsxs("div",{className:"flex gap-3 p-3 hover:bg-gray-50 rounded-xl transition-colors",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0 border border-gray-200",children:e.jsx("img",{src:w.cover_image||"/no-image.png",className:"w-full h-full object-cover",onError:u,alt:w.product_name})}),e.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center",children:[e.jsx("div",{className:"font-medium text-gray-800 truncate",children:w.product_name}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1 inline-flex gap-2",children:[e.jsx("span",{className:"bg-gray-100 px-2 py-0.5 rounded text-gray-600",children:w.size}),e.jsx("span",{className:"bg-gray-100 px-2 py-0.5 rounded text-gray-600",children:w.color})]})]}),e.jsxs("div",{className:"text-right flex flex-col justify-center",children:[e.jsx("div",{className:"font-bold text-gray-800",children:le(w.price)}),e.jsxs("div",{className:"text-xs text-gray-500",children:["x",w.quantity]})]})]},T))})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-5 rounded-2xl border-2 border-dashed border-gray-300",children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[e.jsx("span",{children:"Tá»•ng tiá»n hÃ ng:"}),e.jsx("span",{className:"font-medium",children:le(N)})]}),e.jsxs("div",{className:"flex justify-between text-sm text-green-600 font-bold bg-green-50 px-2 py-1 rounded mb-3",children:[e.jsx("span",{children:"ÄÃ£ Ä‘áº·t cá»c:"}),e.jsxs("span",{children:["- ",le(C)]})]}),e.jsx("div",{className:"border-t border-gray-200 my-3"}),e.jsxs("div",{className:"flex justify-between items-center pb-2",children:[e.jsxs("span",{className:"font-bold text-gray-800 text-lg flex items-center gap-2",children:[e.jsx(ce,{className:"text-red-500 bg-red-100 rounded-full p-1 w-6 h-6"}),"Cáº¦N THU (COD)"]}),e.jsx("span",{className:"text-2xl font-extrabold text-red-600",children:le(z)})]})]})]})]})]},l.id)}function ds(){const[t,n]=o.useState([]),[d,r]=o.useState(null),[a,l]=o.useState(""),[m,j]=o.useState("all"),[x,g]=o.useState(!1),[i,f]=o.useState(!1),[y,k]=o.useState("list"),{setIsNavVisible:p}=te(),s=o.useRef(0);o.useEffect(()=>{u(),p(!0)},[]);const c=_=>{const $=_.target.scrollTop;$<0||($>s.current&&$>50?p(!1):$<s.current&&p(!0),s.current=$)},u=async(_="")=>{g(!0);try{const $=_?`/orders?q=${encodeURIComponent(_)}`:"/orders",L=await P($);n(L)}catch($){console.error("âŒ Lá»—i load orders:",$),S.error("âŒ KhÃ´ng thá»ƒ táº£i danh sÃ¡ch Ä‘Æ¡n hÃ ng")}finally{g(!1)}},C=_=>{_.preventDefault(),u(a),y!=="list"&&k("list")},N=(_,$)=>{n(L=>L.map(I=>I.id===_?{...I,china_tracking_code:$}:I)),d&&d.id===_&&r(L=>({...L,china_tracking_code:$}))},z=async(_,$=null)=>{const L=$||d?.id;if(!L)return S.error("âš ï¸ ChÆ°a chá»n Ä‘Æ¡n hÃ ng!");const D={pending:"pending",confirmed:"confirmed",shipping:"shipping",completed:"completed",cancelled:"cancelled"}[_]||_;try{f(!0),await P(`/orders/${L}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:D})}),S.success(`Cáº­p nháº­t Ä‘Æ¡n #${L} thÃ nh cÃ´ng`),n(V=>V.map(h=>h.id===L?{...h,status:D}:h)),d?.id===L&&r(V=>({...V,status:D}))}catch{S.error("âŒ KhÃ´ng thá»ƒ cáº­p nháº­t tráº¡ng thÃ¡i")}finally{f(!1)}},w=t.filter(_=>m==="all"?!0:_.status===m),T=()=>{const _=["ID","KhÃ¡ch hÃ ng","MÃ£ Váº­n ÄÆ¡n","Tá»•ng tiá»n","Tráº¡ng thÃ¡i"],$=t.map(D=>[D.id,D.customer_name,D.china_tracking_code||"",D.total,D.status]),L="data:text/csv;charset=utf-8,"+[_,...$].map(D=>D.join(",")).join(`
`),I=document.createElement("a");I.href=encodeURI(L),I.download="orders.csv",I.click()};return e.jsxs("div",{className:"h-[100dvh] w-full flex flex-col bg-gray-50 dark:bg-gray-900 md:bg-transparent overflow-hidden",children:[e.jsxs("div",{className:"shrink-0 flex items-center gap-2 p-3 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 md:hidden z-20 shadow-sm",children:[e.jsxs("form",{onSubmit:C,className:"flex-1 flex items-center bg-gray-100 dark:bg-gray-700 px-3 py-2 rounded-xl transition-all focus-within:ring-2 focus-within:ring-blue-400",children:[e.jsx("input",{className:"flex-1 outline-none bg-transparent text-sm dark:text-gray-100 min-w-0",placeholder:"ðŸ” TÃ¬m mÃ£ váº­n Ä‘Æ¡n...",value:a,onChange:_=>l(_.target.value)}),a&&e.jsx("button",{type:"button",onClick:()=>{l(""),u("")},className:"text-gray-400 text-xs ml-2",children:"âœ•"})]}),e.jsxs("div",{className:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1 shrink-0",children:[e.jsx("button",{onClick:()=>k("list"),className:`p-2 rounded-md transition-all ${y==="list"?"bg-white dark:bg-gray-600 text-blue-600 shadow-sm":"text-gray-400"}`,children:e.jsx(se,{className:"text-lg"})}),e.jsx("button",{disabled:!d,onClick:()=>d&&k("detail"),className:`p-2 rounded-md transition-all ${y==="detail"?"bg-white dark:bg-gray-600 text-blue-600 shadow-sm":"text-gray-400"} ${d?"":"opacity-30"}`,children:e.jsx(oe,{className:"text-lg"})})]})]}),e.jsxs("div",{className:"hidden md:grid md:grid-cols-2 gap-6 p-4 animate-fadeIn h-full overflow-hidden",children:[e.jsxs(v.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},className:"card flex flex-col overflow-hidden h-full",children:[e.jsxs("div",{className:"flex flex-wrap items-center justify-between mb-4 gap-3 shrink-0",children:[e.jsxs("h3",{className:"font-bold text-xl flex items-center gap-2 text-gray-800 dark:text-gray-100",children:[e.jsx(X,{className:"text-blue-500"})," ÄÆ¡n hÃ ng"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:T,className:"btn-outline text-xs p-2",children:e.jsx(rt,{})}),e.jsx("button",{onClick:()=>u(a),className:"btn-outline text-xs p-2",children:e.jsx(ve,{})})]})]}),e.jsxs("div",{className:"space-y-2 mb-3 shrink-0",children:[e.jsxs("form",{onSubmit:C,className:"flex items-center bg-gray-100 dark:bg-gray-700 rounded-lg px-3 py-2 border border-transparent focus-within:border-blue-500 transition-all",children:[e.jsx(U,{className:"text-gray-400 mr-2"}),e.jsx("input",{className:"flex-1 bg-transparent outline-none text-sm dark:text-gray-100 font-mono",placeholder:"ðŸ” Nháº­p 4 sá»‘ cuá»‘i mÃ£ váº­n Ä‘Æ¡n, SÄT...",value:a,onChange:_=>l(_.target.value)})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_t,{className:"text-gray-400 mt-2"}),e.jsxs("select",{value:m,onChange:_=>j(_.target.value),className:"flex-1 border rounded px-2 py-1 text-sm dark:bg-gray-800 dark:border-gray-700",children:[e.jsx("option",{value:"all",children:"Táº¥t cáº£ tráº¡ng thÃ¡i"}),e.jsx("option",{value:"pending",children:"Chá» xá»­ lÃ½"}),e.jsx("option",{value:"shipping",children:"Äang giao"}),e.jsx("option",{value:"completed",children:"HoÃ n táº¥t"}),e.jsx("option",{value:"cancelled",children:"ÄÃ£ huá»·"})]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar",children:e.jsx(Ke,{filtered:w,loading:x,selected:d,setSelected:r})})]}),e.jsxs(v.div,{initial:{opacity:0,x:10},animate:{opacity:1,x:0},className:"card overflow-y-auto h-full",children:[e.jsxs("h3",{className:"font-bold text-xl mb-4 flex items-center gap-2 sticky top-0 bg-white dark:bg-gray-800 z-10 pb-2 border-b",children:[e.jsx(oe,{className:"text-green-500"})," Chi tiáº¿t Ä‘Æ¡n hÃ ng"]}),e.jsx(fe,{selected:d,updateStatus:z,updating:i,onUpdateTracking:N})]})]}),e.jsxs("div",{className:"md:hidden flex-1 flex flex-col w-full overflow-hidden bg-gray-50 dark:bg-gray-900",children:[y==="list"&&e.jsx("div",{onScroll:c,className:"flex-1 overflow-y-auto pb-0 px-1 scroll-smooth no-scrollbar",children:e.jsx(Ke,{filtered:w,loading:x,selected:d,setSelected:_=>{r(_),k("detail")}})}),y==="detail"&&e.jsx("div",{onScroll:c,className:"flex-1 overflow-y-auto p-0 bg-white dark:bg-gray-800 pb-0 no-scrollbar",children:e.jsx(fe,{selected:d,updateStatus:z,updating:i,onUpdateTracking:N})})]})]})}function cs({options:t,viewMode:n,setViewMode:d,className:r=""}){return e.jsx("div",{className:`
        md:hidden
        fixed top-0 left-0 right-0 z-[9999]
        backdrop-blur-md bg-white/80 dark:bg-gray-900/70
        border-b border-gray-200 dark:border-gray-700
        shadow-lg shadow-black/5
        px-3 py-2
        ${r}
      `,style:{height:"64px"},children:e.jsx("div",{className:"flex gap-2 h-full",children:t.map(a=>{const l=n===a.value;return e.jsxs(v.button,{whileTap:{scale:.95},onClick:()=>{a.disabled||(a.onClick?.(),d(a.value))},disabled:a.disabled,className:`
                flex-1 flex items-center justify-center gap-2
                px-3 py-2 rounded-2xl text-sm font-medium
                transition-all duration-200 select-none relative
                ${l?"bg-gradient-to-r from-blue-600 to-blue-500 text-white shadow-md shadow-blue-500/30":"bg-gray-100/80 dark:bg-gray-800/60 text-gray-600 dark:text-gray-300"}
                ${a.disabled?"opacity-40":""}
              `,children:[a.icon&&e.jsx(v.div,{animate:{scale:l?1.15:1},transition:{duration:.25},children:e.jsx(a.icon,{size:18,className:l?"text-white":"text-gray-500"})}),e.jsx(v.span,{animate:{opacity:l?1:.8},className:"text-[13px]",children:a.label}),l&&e.jsx(v.div,{layoutId:"tabs-glow",className:"absolute inset-0 rounded-2xl ring-2 ring-blue-400/50",style:{zIndex:-1},transition:{type:"spring",stiffness:300,damping:25}})]},a.value)})})})}function qe({customers:t,isNewCustomer:n,setIsNewCustomer:d,newCustomer:r,setNewCustomer:a,customerId:l,setCustomerId:m}){const[j,x]=o.useState(""),g=t.filter(i=>{const f=j.toLowerCase(),y=i.name?.toLowerCase().includes(f),k=i.phone?.includes(f);return y||k});return o.useEffect(()=>{n&&m("")},[n,m]),e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-4 rounded-xl shadow-sm border border-gray-100 dark:border-gray-700",children:[e.jsxs("h3",{className:"font-bold text-xl mb-4 flex items-center gap-2 text-gray-700 dark:text-gray-200",children:[e.jsx(he,{className:"text-blue-500"})," KhÃ¡ch hÃ ng"]}),e.jsxs("div",{className:"flex items-center gap-2 mb-4 bg-gray-100 dark:bg-gray-700 p-1 rounded-lg w-fit",children:[e.jsx("button",{onClick:()=>d(!1),className:`px-3 py-1.5 text-sm rounded-md transition-all ${n?"text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600":"bg-white dark:bg-gray-600 shadow text-blue-600 font-semibold"}`,children:"Chá»n cÃ³ sáºµn"}),e.jsx("button",{onClick:()=>d(!0),className:`px-3 py-1.5 text-sm rounded-md transition-all ${n?"bg-white dark:bg-gray-600 shadow text-blue-600 font-semibold":"text-gray-500 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-600"}`,children:"+ Táº¡o má»›i"})]}),n?e.jsxs("div",{className:"grid gap-3 animate-fadeIn",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 mb-1 block",children:"TÃªn khÃ¡ch *"}),e.jsx("input",{className:"w-full border p-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-700",placeholder:"Nháº­p tÃªn...",value:r.name,onChange:i=>a({...r,name:i.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 mb-1 block",children:"Sá»‘ Ä‘iá»‡n thoáº¡i *"}),e.jsx("input",{className:"w-full border p-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-700",placeholder:"Nháº­p SÄT...",value:r.phone,onChange:i=>a({...r,phone:i.target.value})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 mb-1 block",children:"Äá»‹a chá»‰"}),e.jsx("input",{className:"w-full border p-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-700",placeholder:"Sá»‘ nhÃ , Ä‘Æ°á»ng, quáº­n/huyá»‡n...",value:r.address,onChange:i=>a({...r,address:i.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-gray-500 mb-1 block",children:"Facebook URL (TÃ¹y chá»n)"}),e.jsx("input",{className:"w-full border p-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-700",placeholder:"https://facebook.com/...",value:r.facebook_url,onChange:i=>a({...r,facebook_url:i.target.value})})]}),e.jsx("textarea",{className:"w-full border p-2 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-700",placeholder:"Ghi chÃº thÃªm vá» khÃ¡ch...",rows:2,value:r.notes,onChange:i=>a({...r,notes:i.target.value})})]}):e.jsxs("div",{className:"space-y-3 animate-fadeIn",children:[e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx("input",{className:"w-full pl-10 pr-10 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100",placeholder:"GÃµ tÃªn hoáº·c SÄT Ä‘á»ƒ tÃ¬m...",value:j,onChange:i=>x(i.target.value)}),j&&e.jsx("button",{onClick:()=>x(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-red-500",children:e.jsx(G,{})})]}),e.jsxs("select",{className:"w-full p-2 border rounded-lg bg-gray-50 dark:bg-gray-900 dark:border-gray-700 dark:text-gray-100 focus:outline-none focus:border-blue-500",value:l,onChange:i=>m(i.target.value),size:g.length>5?5:void 0,children:[e.jsx("option",{value:"",children:g.length===0?"âŒ KhÃ´ng tÃ¬m tháº¥y khÃ¡ch nÃ o":"-- Chá»n khÃ¡ch hÃ ng tá»« danh sÃ¡ch --"}),g.map(i=>e.jsxs("option",{value:i.id,children:[i.name," â€” ",i.phone||"KhÃ´ng cÃ³ SÄT"]},i.id))]}),j&&g.length===0&&e.jsxs("div",{className:"text-sm text-center text-gray-500 mt-2",children:["KhÃ´ng tÃ¬m tháº¥y khÃ¡ch hÃ ng nÃ o. ",e.jsx("br",{}),e.jsx("button",{onClick:()=>d(!0),className:"text-blue-600 hover:underline font-semibold",children:"Táº¡o khÃ¡ch hÃ ng má»›i ngay?"})]})]})]})}const xs=t=>Number(t||0).toLocaleString("vi-VN")+"Ä‘";function Be({products:t,variants:n,selectedProductId:d,setSelectedProductId:r,loadVariants:a,items:l,setItems:m,loadingVariants:j=!1}){const[x,g]=o.useState(""),[i,f]=o.useState(t);o.useEffect(()=>{if(!x.trim())f(t);else{const p=x.toLowerCase(),s=t.filter(c=>c.name.toLowerCase().includes(p)||c.sku&&c.sku.toLowerCase().includes(p));f(s)}},[x,t]);const y=(p,s)=>{if(s.stock<=0){S.error("Sáº£n pháº©m háº¿t hÃ ng!");return}const c=Number(s.sale_price||p.sale_price||0);m(u=>{const C=u.findIndex(N=>N.variant_id===s.id);if(C>=0){const N=[...u],z=N[C].quantity+1;return z>s.stock?(S.info(`âš ï¸ Kho chá»‰ cÃ²n ${s.stock} sáº£n pháº©m`),u):(N[C].quantity=z,N)}else return[{product_id:p.id,product_name:p.name,product_image:p.cover_image,variant_id:s.id,size:s.size,color:s.color,quantity:1,price:c,stock:s.stock},...u]})},k=p=>l.some(s=>s.variant_id===p);return e.jsxs("div",{className:"h-full flex flex-col bg-gray-50/50 rounded-xl border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"flex-shrink-0 bg-white p-3 border-b shadow-sm z-10",children:e.jsxs("div",{className:"relative",children:[e.jsx(U,{className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{className:"w-full bg-gray-100 pl-10 pr-10 py-2.5 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:bg-white transition-all font-medium",placeholder:"TÃ¬m tÃªn sáº£n pháº©m, mÃ£ SKU...",value:x,onChange:p=>g(p.target.value)}),x&&e.jsx("button",{onClick:()=>g(""),className:"absolute right-3 top-3 text-gray-400 hover:text-gray-600",children:e.jsx(G,{})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3 custom-scrollbar",children:i.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-40 text-gray-400",children:[e.jsx(U,{size:24,className:"mb-2 opacity-50"}),e.jsx("span",{className:"text-sm",children:"KhÃ´ng tÃ¬m tháº¥y sáº£n pháº©m nÃ o."})]}):e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3",children:i.map(p=>{const s=d===p.id,c=p.sale_price||p.price;return e.jsxs(v.div,{layout:!0,initial:{opacity:0},animate:{opacity:1},className:`
                    relative flex flex-col bg-white border rounded-xl overflow-hidden cursor-pointer transition-all duration-200
                    ${s?"ring-2 ring-blue-500 border-transparent shadow-lg scale-[1.02] z-10":"border-gray-100 hover:border-blue-300 hover:shadow-md"}
                  `,onClick:()=>{s||(r(p.id),a(p.id))},children:[e.jsxs("div",{className:"aspect-square bg-gray-100 relative group",children:[p.cover_image?e.jsx("img",{src:p.cover_image,alt:"",className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300 bg-gray-50",children:e.jsx(re,{size:24})}),e.jsx("div",{className:"absolute top-2 right-2 bg-white/90 backdrop-blur text-blue-700 text-[10px] font-bold px-2 py-1 rounded shadow-sm",children:xs(c)}),!s&&e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/5 transition-colors"})]}),e.jsx("div",{className:"p-2 border-b border-gray-50",children:e.jsx("h3",{className:"text-xs font-bold text-gray-700 line-clamp-1",title:p.name,children:p.name})}),e.jsx(A,{children:s&&e.jsx(v.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-blue-50/30",children:e.jsx("div",{className:"p-2",children:j?e.jsx("div",{className:"flex justify-center py-2",children:e.jsx("div",{className:"w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full animate-spin"})}):n.length===0?e.jsxs("div",{className:"text-[10px] text-red-500 text-center py-1 flex items-center justify-center gap-1",children:[e.jsx(tt,{})," Háº¿t hÃ ng / Lá»—i"]}):e.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:n.map(u=>{const C=k(u.id),N=u.stock<=0;return e.jsxs("button",{disabled:N,onClick:z=>{z.stopPropagation(),y(p,u)},className:`
                                      relative text-[10px] py-1.5 px-1 rounded border text-center font-medium transition-all
                                      ${N?"bg-gray-100 text-gray-400 border-gray-100 cursor-not-allowed decoration-slice":C?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-gray-600 border-gray-200 hover:border-blue-400 hover:text-blue-600 hover:bg-blue-50"}
                                    `,children:[e.jsxs("span",{className:N?"line-through":"",children:[u.size||"F"," / ",u.color||"Basic"]}),C&&!N&&e.jsx("div",{className:"absolute -top-1 -right-1 bg-green-500 text-white rounded-full p-[1px] shadow-sm z-10",children:e.jsx(et,{size:8})})]},u.id)})})})})})]},p.id)})})})]})}const Re="http://localhost:5000/api",q=t=>Number(t||0).toLocaleString("vi-VN",{maximumFractionDigits:0})+"Ä‘",gs=t=>t?Number(t).toLocaleString("vi-VN"):"";function Ue({items:t,setItems:n,deposit:d,setDeposit:r,note:a,setNote:l,customerId:m,customers:j,isNewCustomer:x,newCustomer:g,setNewCustomer:i,createdOrder:f,setCreatedOrder:y,loading:k,setLoading:p,loadVariants:s,selectedProductId:c}){const[u,C]=o.useState(""),[N,z]=o.useState(!1);o.useEffect(()=>{const b=()=>z(window.innerWidth<768);return b(),window.addEventListener("resize",b),()=>window.removeEventListener("resize",b)},[]);const w=(b,F)=>{n(O=>{const E=Math.max(1,Number(F||1)),M=[...O];return M[b]={...M[b],quantity:E},M})},T=b=>{n(F=>F.filter((O,E)=>E!==b))},_=Number(String(d).replace(/\./g,""))||0,$=t.reduce((b,F)=>b+F.price*F.quantity,0),L=$-_,I=!k&&t.length>0&&(!!m||x&&g.name?.trim()),D=async()=>{if(!I)return;if(x&&(!g.name||!g.phone))return S.error("Vui lÃ²ng nháº­p tÃªn vÃ  SÄT khÃ¡ch hÃ ng!");p(!0);let b=m;const F=localStorage.getItem("token"),O={"Content-Type":"application/json",...F&&{Authorization:`Bearer ${F}`}};try{if(x){const B=await fetch(`${Re}/customers`,{method:"POST",headers:O,body:JSON.stringify(g)}),R=await B.json();if(!B.ok)throw new Error(R.message||"Lá»—i táº¡o khÃ¡ch hÃ ng");b=R.id}const E={customer_id:Number(b),note:a,china_tracking_code:u,deposit:_,items:t.map(B=>({variant_id:B.variant_id||null,quantity:B.quantity,price:B.price}))},M=await fetch(`${Re}/orders`,{method:"POST",headers:O,body:JSON.stringify(E)}),Y=await M.json();if(!M.ok)throw new Error(Y.message||"Lá»—i táº¡o Ä‘Æ¡n hÃ ng");c&&typeof s=="function"&&await s(c),y({id:Y.id,customer:x||!m?g:j.find(B=>String(B.id)===String(m)),total:$,deposit:_,note:a,items:t,china_tracking_code:u}),n([]),l(""),C(""),r(""),S.success(`âœ… ÄÆ¡n hÃ ng #${Y.id} Ä‘Ã£ Ä‘Æ°á»£c táº¡o thÃ nh cÃ´ng!`)}catch(E){console.error(E),S.error("âŒ "+(E.message||"Lá»—i khi táº¡o Ä‘Æ¡n hÃ ng"))}finally{p(!1)}},V=()=>{if(!f)return;const b=new Bt;b.setFontSize(18),b.text("HOA DON BAN HANG",105,20,{align:"center"}),b.setFontSize(12),b.text(`Ma don: #${f.id}`,14,30);const F=f.customer?.name||"Khach le";b.text(`Khach hang: ${F}`,14,36),b.text(`SDT: ${f.customer?.phone||""}`,14,42);const O=f.items.map((M,Y)=>[Y+1,M.product_name,`${M.size||"-"}/${M.color||"-"}`,M.quantity,q(M.price),q(M.price*M.quantity)]);b.autoTable({startY:55,head:[["#","San pham","Phan loai","SL","Gia","Thanh tien"]],body:O,theme:"grid",styles:{fontSize:10},headStyles:{fillColor:[41,128,185]}});const E=b.lastAutoTable.finalY+10;b.text(`Tong tien: ${q(f.total)}`,140,E),b.text(`Da coc: ${q(f.deposit)}`,140,E+6),b.setFont(void 0,"bold"),b.text(`CON LAI: ${q(f.total-(f.deposit||0))}`,140,E+14),b.save(`HoaDon_${f.id}.pdf`)},h=j.find(b=>b.id===Number(m));return e.jsxs(v.div,{initial:{opacity:0,y:N?40:12},animate:{opacity:1,y:0},className:`bg-white rounded-2xl border shadow-md flex flex-col
        ${N?"fixed left-0 right-0 bottom-[60px] top-[70px] z-40 p-4 overflow-hidden":"p-6"}
      `,style:{height:N?"calc(100vh - 130px)":"auto",WebkitOverflowScrolling:"touch"},children:[e.jsx("div",{className:"flex-shrink-0 pb-3 border-b mb-2",children:e.jsxs("h3",{className:"font-bold text-xl flex items-center gap-2 text-gray-700",children:[e.jsx(ie,{className:"text-green-600"})," Giá» hÃ ng (",t.length,")"]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto pr-1 space-y-4",children:[e.jsxs("div",{className:"bg-blue-50/50 p-3 rounded-xl border border-blue-100",children:[e.jsxs("div",{className:"flex items-center gap-2 text-blue-800 font-bold text-xs uppercase mb-2",children:[e.jsx(he,{})," ThÃ´ng tin nháº­n hÃ ng"]}),x?e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx("div",{className:"col-span-2",children:e.jsx("input",{placeholder:"TÃªn khÃ¡ch hÃ ng",className:"w-full bg-white border border-blue-200 rounded px-2 py-1.5 text-sm focus:outline-blue-500",value:g.name,onChange:b=>i({...g,name:b.target.value})})}),e.jsx("div",{children:e.jsx("input",{placeholder:"SÄT",className:"w-full bg-white border border-blue-200 rounded px-2 py-1.5 text-sm focus:outline-blue-500",value:g.phone,onChange:b=>i({...g,phone:b.target.value})})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(at,{className:"absolute top-2 left-2 text-gray-400",size:14}),e.jsx("input",{placeholder:"Äá»‹a chá»‰ giao hÃ ng",className:"w-full bg-white border border-blue-200 rounded pl-7 pr-2 py-1.5 text-sm focus:outline-blue-500",value:g.address,onChange:b=>i({...g,address:b.target.value})})]})]}):h?e.jsxs("div",{className:"text-sm",children:[e.jsxs("div",{className:"font-bold text-gray-800",children:[h.name," ",e.jsxs("span",{className:"font-normal text-gray-500",children:["- ",h.phone]})]}),e.jsx("div",{className:"text-gray-500 truncate",children:h.address||"ChÆ°a cÃ³ Ä‘á»‹a chá»‰"})]}):e.jsx("div",{className:"text-sm text-red-500 italic",children:"ChÆ°a chá»n khÃ¡ch hÃ ng"})]}),t.length===0?e.jsx("div",{className:"text-gray-500 italic text-center py-8 text-sm border-2 border-dashed rounded-xl",children:"ðŸ›’ Giá» hÃ ng trá»‘ng"}):e.jsx("div",{className:"space-y-2",children:t.map((b,F)=>e.jsxs("div",{className:"flex gap-3 bg-white border rounded-xl p-2 relative",children:[e.jsx("button",{onClick:()=>T(F),className:"absolute top-1 right-1 text-gray-300 hover:text-red-500 p-1",children:e.jsx(We,{size:16})}),e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-lg flex-shrink-0 flex items-center justify-center text-xs text-gray-400",children:"IMG"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-sm truncate pr-6",children:b.product_name}),e.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:[b.size||"-"," / ",b.color||"-"]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center border rounded-lg bg-gray-50",children:[e.jsx("button",{onClick:()=>w(F,b.quantity-1),className:"px-2 py-0.5 text-gray-600 hover:bg-gray-200 rounded-l-lg",children:"-"}),e.jsx("span",{className:"px-2 text-xs font-bold w-8 text-center",children:b.quantity}),e.jsx("button",{onClick:()=>w(F,b.quantity+1),className:"px-2 py-0.5 text-gray-600 hover:bg-gray-200 rounded-r-lg",children:"+"})]}),e.jsx("div",{className:"font-bold text-sm text-blue-600",children:q(b.price*b.quantity)})]})]})]},F))}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"bg-yellow-50 p-2 rounded-lg border border-yellow-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"text-yellow-700"}),e.jsx("input",{className:"flex-1 bg-transparent text-sm outline-none placeholder-yellow-700/50 text-yellow-900",placeholder:"MÃ£ váº­n Ä‘Æ¡n TQ (TÃ¹y chá»n)",value:u,onChange:b=>C(b.target.value)})]})}),e.jsx("textarea",{className:"w-full border rounded-lg p-2 text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 resize-none bg-gray-50",rows:2,placeholder:"Ghi chÃº Ä‘Æ¡n hÃ ng...",value:a,onChange:b=>l(b.target.value)})]}),e.jsx("div",{className:"h-24 sm:h-0"})]}),e.jsxs("div",{className:"mt-auto pt-3 border-t bg-white sticky bottom-0 space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Tá»•ng tiá»n hÃ ng:"}),e.jsx("span",{className:"font-medium",children:q($)})]}),e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsx("span",{className:"text-gray-500 flex items-center gap-1",children:"ÄÃ£ Ä‘áº·t cá»c:"}),e.jsxs("div",{className:"w-32 relative",children:[e.jsx("input",{type:"text",inputMode:"numeric",value:gs(d),placeholder:"0",onChange:b=>{const F=b.target.value.replace(/\./g,"").replace(/\D/g,"");r(F)},className:`w-full text-right font-bold text-green-600
                           border-b border-gray-200 focus:border-green-500
                           outline-none py-0.5 bg-transparent pr-4`}),e.jsx("span",{className:"absolute right-0 top-0.5 text-xs text-gray-400 pointer-events-none",children:"Ä‘"})]})]}),e.jsxs("div",{className:"flex justify-between items-center bg-gray-100 p-2 rounded-lg",children:[e.jsx("span",{className:"font-bold text-gray-700",children:"CÃ’N PHáº¢I THU:"}),e.jsx("span",{className:"font-black text-lg text-red-600",children:q(L)})]}),e.jsx("button",{className:`w-full py-3 text-white font-bold rounded-xl shadow-lg transition-transform active:scale-95 flex items-center justify-center gap-2 ${I?"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800":"bg-gray-300 cursor-not-allowed"}`,onClick:D,disabled:!I,children:k?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Äang xá»­ lÃ½..."]}):e.jsx(e.Fragment,{children:"âœ… Táº¡o Ä‘Æ¡n hÃ ng"})})]}),e.jsx(A,{children:f&&e.jsxs(v.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"absolute inset-0 bg-white z-50 flex flex-col items-center justify-center p-6 rounded-2xl",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(je,{className:"text-green-600 text-4xl"})}),e.jsx("h3",{className:"font-bold text-2xl text-green-700 mb-2 text-center",children:"Táº¡o Ä‘Æ¡n thÃ nh cÃ´ng!"}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl w-full mb-6 border border-gray-100 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"MÃ£ Ä‘Æ¡n:"})," ",e.jsxs("b",{children:["#",f.id]})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"KhÃ¡ch:"})," ",e.jsx("b",{children:f.customer?.name})]}),e.jsx("div",{className:"border-t border-dashed my-2"}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Tá»•ng tiá»n:"})," ",e.jsx("span",{children:q(f.total)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"ÄÃ£ cá»c:"})," ",e.jsx("span",{children:q(f.deposit)})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold text-red-600 pt-2 border-t",children:[e.jsx("span",{children:"CÃ²n láº¡i:"}),e.jsx("span",{children:q(f.total-(f.deposit||0))})]})]}),e.jsxs("div",{className:"flex gap-3 w-full",children:[e.jsx("button",{onClick:()=>y(null),className:"flex-1 py-3 bg-gray-100 text-gray-700 font-bold rounded-xl hover:bg-gray-200",children:"Táº¡o Ä‘Æ¡n má»›i"}),e.jsx("button",{onClick:V,className:"flex-1 py-3 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 shadow-lg shadow-blue-200",children:"In hÃ³a Ä‘Æ¡n"})]})]})})]})}function hs(){const[t,n]=o.useState([]),[d,r]=o.useState([]),[a,l]=o.useState([]),[m,j]=o.useState(!1),[x,g]=o.useState(""),[i,f]=o.useState(!1),[y,k]=o.useState({name:"",phone:"",address:"",facebook_url:"",notes:""}),[p,s]=o.useState(""),[c,u]=o.useState([]),[C,N]=o.useState(""),[z,w]=o.useState(""),[T,_]=o.useState(!1),[$,L]=o.useState(null),[I,D]=o.useState("customer"),V=[{value:"customer",label:"KhÃ¡ch",icon:he},{value:"products",label:"Sáº£n pháº©m",icon:H},{value:"cart",label:"Giá» hÃ ng",icon:ie,disabled:c.length===0,onClick:()=>{c.length===0&&S.info("ðŸ›’ ChÆ°a cÃ³ sáº£n pháº©m nÃ o!")}}];o.useEffect(()=>{(async()=>{try{const[b,F]=await Promise.all([P("/customers"),P("/products")]);n(b),r(F)}catch{S.error("âš ï¸ KhÃ´ng thá»ƒ táº£i dá»¯ liá»‡u khÃ¡ch hoáº·c sáº£n pháº©m")}})()},[]);const h=o.useCallback(async b=>{if(!b)return l([]);j(!0);try{const F=await P(`/variants/by-product/${b}`);l(F)}catch{S.error("âš ï¸ KhÃ´ng thá»ƒ táº£i biáº¿n thá»ƒ")}finally{j(!1)}},[]);return o.useEffect(()=>{p&&h(p)},[p,h]),e.jsxs(e.Fragment,{children:[e.jsx(cs,{options:V,viewMode:I,setViewMode:D,className:"fixed top-0 left-0 right-0 z-50 bg-white shadow-md"}),e.jsxs("div",{className:"hidden md:grid md:grid-cols-2 gap-6 p-4 pb-20 md:pb-10 h-[calc(100vh-60px)] overflow-hidden",children:[e.jsxs(v.div,{initial:{opacity:0,y:12},animate:{opacity:1,y:0},className:"bg-white p-6 rounded-2xl border shadow-sm overflow-y-auto h-full space-y-6",children:[e.jsx(qe,{customers:t,isNewCustomer:i,setIsNewCustomer:f,newCustomer:y,setNewCustomer:k,customerId:x,setCustomerId:g}),e.jsx("div",{className:"border-t pt-4",children:e.jsx(Be,{products:d,variants:a,selectedProductId:p,setSelectedProductId:s,loadVariants:h,items:c,setItems:u,loadingVariants:m})})]}),e.jsx(Ue,{items:c,setItems:u,deposit:C,setDeposit:N,note:z,setNote:w,customerId:x,customers:t,isNewCustomer:i,newCustomer:y,setNewCustomer:k,createdOrder:$,setCreatedOrder:L,loading:T,setLoading:_,loadVariants:h,selectedProductId:p})]}),e.jsxs("div",{className:"md:hidden px-4 pt-[70px] pb-[80px]",children:[I==="customer"&&e.jsxs(v.div,{initial:{opacity:0},animate:{opacity:1},children:[e.jsx(qe,{customers:t,isNewCustomer:i,setIsNewCustomer:f,newCustomer:y,setNewCustomer:k,customerId:x,setCustomerId:g}),e.jsx("button",{onClick:()=>D("products"),className:"w-full mt-4 bg-blue-600 text-white py-3 rounded-xl font-bold shadow-lg",children:"Tiáº¿p tá»¥c chá»n sáº£n pháº©m â†’"})]},"customer"),I==="products"&&e.jsxs(v.div,{initial:{opacity:0},animate:{opacity:1},children:[e.jsx(Be,{products:d,variants:a,selectedProductId:p,setSelectedProductId:s,loadVariants:h,items:c,setItems:u,loadingVariants:m}),c.length>0&&e.jsxs("button",{onClick:()=>D("cart"),className:"fixed bottom-20 right-4 bg-green-600 text-white px-6 py-3 rounded-full shadow-xl font-bold flex items-center gap-2 animate-bounce",children:[e.jsx(ie,{})," Giá» hÃ ng (",c.length,")"]})]},"products"),I==="cart"&&e.jsx(v.div,{initial:{opacity:0},animate:{opacity:1},children:e.jsx(Ue,{items:c,setItems:u,deposit:C,setDeposit:N,note:z,setNote:w,customerId:x,customers:t,isNewCustomer:i,newCustomer:y,setNewCustomer:k,createdOrder:$,setCreatedOrder:L,loading:T,setLoading:_,loadVariants:h,selectedProductId:p})},"cart")]})]})}function ms(){const[t,n]=o.useState([]),[d,r]=o.useState(!0),[a,l]=o.useState({reason:"all",startDate:"",endDate:""}),[m,j]=o.useState("timeline"),{setIsNavVisible:x}=te(),g=o.useRef(0),i=s=>{const c=s.target.scrollTop;c<0||(c>g.current&&c>50?x(!1):c<g.current&&x(!0),g.current=c)};o.useEffect(()=>{x(!0),f()},[]);const f=async()=>{try{r(!0);const s=new URLSearchParams;a.reason!=="all"&&s.append("reason",a.reason),a.startDate&&s.append("start",a.startDate),a.endDate&&s.append("end",a.endDate);const c=await P(`/stock/history?${s.toString()}`);n(c),c.length===0&&S.info("KhÃ´ng cÃ³ báº£n ghi phÃ¹ há»£p.")}catch{S.error("KhÃ´ng thá»ƒ táº£i lá»‹ch sá»­ kho!")}finally{r(!1)}},y=o.useMemo(()=>{const s={};return t.forEach(c=>{const u=new Date(c.created_at).toISOString().split("T")[0];s[u]||(s[u]=[]),s[u].push(c)}),Object.entries(s).sort((c,u)=>c[0]<u[0]?1:-1).map(([c,u])=>({date:c,items:u}))},[t]),k=()=>{if(!t.length)return S.info("KhÃ´ng cÃ³ dá»¯ liá»‡u Ä‘á»ƒ xuáº¥t.");const s=["STT","MÃ£ sáº£n pháº©m","TÃªn sáº£n pháº©m","ThÆ°Æ¡ng hiá»‡u","MÃ u","Size","Thay Ä‘á»•i","LÃ½ do","NgÃ y giá»"].join(","),c=t.map((N,z)=>{const w=N.reason==="import"?"Nháº­p hÃ ng":N.reason==="order"?"BÃ¡n hÃ ng":N.reason,T=new Date(N.created_at).toLocaleString("vi-VN");return[z+1,N.product_sku,`"${N.product_name}"`,N.brand||"-",N.color||"-",N.size||"-",N.change_qty,w,T].join(",")}),u=new Blob(["\uFEFF"+[s,...c].join(`
`)],{type:"text/csv;charset=utf-8;"}),C=document.createElement("a");C.href=URL.createObjectURL(u),C.download=`lich_su_kho_${new Date().toISOString().slice(0,10)}.csv`,C.click(),S.success("ÄÃ£ xuáº¥t file CSV!")},p=({item:s})=>e.jsxs("div",{className:"p-4 rounded-xl border bg-white dark:bg-gray-800 shadow-sm space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-semibold text-gray-800 dark:text-gray-100 line-clamp-1",children:s.product_name}),e.jsx("span",{className:`text-sm font-bold flex-shrink-0 ml-2 ${s.change_qty>0?"text-green-600":"text-red-600"}`,children:s.change_qty>0?`+${s.change_qty}`:s.change_qty})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["SKU: ",s.product_sku," â€¢ ",s.color||"-"," â€¢ ",s.size||"-"]}),e.jsxs("div",{className:"text-xs text-gray-400",children:[s.reason==="import"?"Nháº­p hÃ ng":"BÃ¡n hÃ ng"," â€”"," ",new Date(s.created_at).toLocaleString("vi-VN")]})]});return e.jsxs(e.Fragment,{children:[e.jsx("style",{children:`
        .hide-scroll-force::-webkit-scrollbar { display: none !important; width: 0 !important; }
        .hide-scroll-force { -ms-overflow-style: none !important; scrollbar-width: none !important; }
      `}),e.jsxs("div",{className:"h-[100dvh] w-full bg-gray-50 dark:bg-gray-900 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"shrink-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 p-4 z-10",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"font-bold text-xl flex items-center gap-2 text-gray-800 dark:text-gray-100",children:[e.jsx(X,{className:"text-blue-500"})," Lá»‹ch sá»­ kho"]}),e.jsx("div",{className:"flex bg-gray-100 dark:bg-gray-900 p-1 rounded-lg",children:["table","timeline","card"].map(s=>e.jsxs("button",{onClick:()=>j(s),className:`p-2 rounded-md transition-colors ${m===s?"bg-white dark:bg-gray-700 shadow text-blue-600":"text-gray-400"}`,children:[s==="table"&&e.jsx(se,{}),s==="timeline"&&e.jsx(st,{}),s==="card"&&e.jsx(ae,{})]},s))})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[e.jsxs("select",{value:a.reason,onChange:s=>l(c=>({...c,reason:s.target.value})),className:"border rounded-lg px-3 py-2 text-sm bg-white dark:bg-gray-900 dark:text-white outline-none focus:ring-1 focus:ring-blue-500",children:[e.jsx("option",{value:"all",children:"Táº¥t cáº£ loáº¡i"}),e.jsx("option",{value:"import",children:"Nháº­p hÃ ng"}),e.jsx("option",{value:"order",children:"BÃ¡n hÃ ng"})]}),e.jsx("button",{onClick:f,className:"p-2 bg-blue-100 text-blue-600 rounded-lg hover:bg-blue-200",children:e.jsx(ve,{})}),e.jsxs("button",{onClick:k,className:"ml-auto flex items-center gap-1 text-sm font-medium text-green-600 bg-green-50 px-3 py-2 rounded-lg hover:bg-green-100",children:[e.jsx(rt,{})," ",e.jsx("span",{className:"hidden sm:inline",children:"Xuáº¥t CSV"})]})]})]}),e.jsx("div",{onScroll:i,className:"flex-1 overflow-y-auto hide-scroll-force p-4 pb-24 md:pb-10",children:e.jsx("div",{className:"max-w-5xl mx-auto",children:d?e.jsx("div",{className:"text-center py-10 text-gray-400",children:"â³ Äang táº£i dá»¯ liá»‡u..."}):t.length===0?e.jsx("div",{className:"text-center py-10 text-gray-400",children:"KhÃ´ng cÃ³ lá»‹ch sá»­ nÃ o."}):e.jsxs(e.Fragment,{children:[m==="table"&&e.jsx("div",{className:"overflow-hidden border rounded-xl shadow-sm bg-white dark:bg-gray-800",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm text-left",children:[e.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700 text-gray-500 dark:text-gray-300",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-3",children:"TÃªn SP"}),e.jsx("th",{className:"p-3 text-center",children:"SL"}),e.jsx("th",{className:"p-3",children:"Loáº¡i"}),e.jsx("th",{className:"p-3 text-right",children:"Thá»i gian"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:t.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700/50",children:[e.jsxs("td",{className:"p-3",children:[e.jsx("div",{className:"font-medium text-gray-800 dark:text-gray-200 truncate max-w-[150px] sm:max-w-none",children:s.product_name}),e.jsxs("div",{className:"text-xs text-gray-400",children:["SKU: ",s.product_sku]})]}),e.jsx("td",{className:`p-3 text-center font-bold ${s.change_qty>0?"text-green-600":"text-red-600"}`,children:s.change_qty>0?`+${s.change_qty}`:s.change_qty}),e.jsx("td",{className:"p-3 text-xs",children:e.jsx("span",{className:`px-2 py-1 rounded-full ${s.reason==="import"?"bg-blue-100 text-blue-700":"bg-orange-100 text-orange-700"}`,children:s.reason==="import"?"Nháº­p":"BÃ¡n"})}),e.jsx("td",{className:"p-3 text-right text-gray-500 text-xs",children:new Date(s.created_at).toLocaleString("vi-VN")})]},s.id))})]})})}),m==="timeline"&&e.jsx("div",{className:"space-y-6",children:y.map(s=>e.jsxs("div",{className:"relative pl-4 border-l-2 border-gray-200 dark:border-gray-700",children:[e.jsx("div",{className:"absolute -left-[9px] top-0 w-4 h-4 rounded-full bg-blue-500 ring-4 ring-white dark:ring-gray-900"}),e.jsx("h3",{className:"font-bold text-gray-800 dark:text-gray-100 mb-3 pl-2",children:new Date(s.date).toLocaleDateString("vi-VN",{weekday:"long",day:"numeric",month:"long"})}),e.jsx("div",{className:"space-y-3",children:s.items.map(c=>e.jsxs("div",{className:"bg-white dark:bg-gray-800 p-3 rounded-xl border border-gray-100 dark:border-gray-700 shadow-sm flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-800 dark:text-gray-200",children:c.product_name}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1 flex gap-2",children:[e.jsx("span",{children:new Date(c.created_at).toLocaleTimeString("vi-VN",{hour:"2-digit",minute:"2-digit"})}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"uppercase",children:c.reason==="import"?"Nháº­p kho":"Xuáº¥t kho"})]})]}),e.jsx("span",{className:`font-bold text-sm ${c.change_qty>0?"text-green-600":"text-red-600"}`,children:c.change_qty>0?`+${c.change_qty}`:c.change_qty})]},c.id))})]},s.date))}),m==="card"&&e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(s=>e.jsx(p,{item:s},s.id))})]})})})]})]})}function us(){const[t,n]=o.useState(navigator.onLine);return o.useEffect(()=>{const d=()=>n(!0),r=()=>n(!1);return window.addEventListener("online",d),window.addEventListener("offline",r),()=>{window.removeEventListener("online",d),window.removeEventListener("offline",r)}},[]),t}function bs(){const t=us();return e.jsxs("div",{className:"h-screen w-full flex flex-col bg-gradient-to-b from-[#faf9f7] via-[#f7f5f0] to-[#f4f1ea] text-[#2a2a2a] overflow-hidden",children:[!t&&e.jsxs("div",{className:"bg-red-600 text-white text-xs font-bold py-1.5 px-4 text-center flex items-center justify-center gap-2 shadow-md z-[9999] animate-fadeIn",children:[e.jsx(Tt,{}),"Máº¥t káº¿t ná»‘i Internet - Äang xem dá»¯ liá»‡u Offline"]}),e.jsx("div",{className:"hidden md:block shrink-0",children:e.jsx(Rt,{})}),e.jsx("main",{className:"flex-1 pt-0 md:pt-8 px-0 md:px-8 pb-0 md:pb-8 w-full relative overflow-hidden",children:e.jsx("div",{className:"h-full w-full animate-fadeIn",children:e.jsxs(Ft,{children:[e.jsx(J,{path:"/",element:e.jsx(Xt,{})}),e.jsx(J,{path:"/products",element:e.jsx(as,{})}),e.jsx(J,{path:"/customers",element:e.jsx(is,{})}),e.jsx(J,{path:"/orders",element:e.jsx(ds,{})}),e.jsx(J,{path:"/orders/new",element:e.jsx("div",{className:"h-full overflow-y-auto pb-24",children:e.jsx(hs,{})})}),e.jsx(J,{path:"/orders/:id",element:e.jsx("div",{className:"h-full overflow-y-auto pb-24",children:e.jsx(fe,{})})}),e.jsx(J,{path:"/stock",element:e.jsx(ms,{})})]})})}),e.jsx("div",{className:"block md:hidden",children:e.jsx(Ht,{})})]})}function ps(){return e.jsx(Ut,{children:e.jsx(bs,{})})}const fs=new Pt({defaultOptions:{queries:{networkMode:"offlineFirst",refetchOnWindowFocus:!1,retry:!1,staleTime:1e3*60*60,gcTime:1e3*60*60*24},mutations:{networkMode:"offlineFirst"}}});Lt.createRoot(document.getElementById("root")).render(e.jsx(zt.StrictMode,{children:e.jsx($t,{client:fs,children:e.jsxs(It,{children:[e.jsx(ps,{}),e.jsx(Dt,{position:"top-right",toastOptions:{duration:2500,style:{background:"#fff",color:"#333",borderRadius:"10px",padding:"10px 16px",fontSize:"14px"},success:{iconTheme:{primary:"#16a34a",secondary:"#fff"}},error:{iconTheme:{primary:"#dc2626",secondary:"#fff"}}}})]})})}));
